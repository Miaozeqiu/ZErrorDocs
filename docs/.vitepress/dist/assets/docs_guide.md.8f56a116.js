import{_ as s,o as n,c as a,a as l}from"./app.cafbc5ab.js";const d=JSON.parse('{"title":"\u4F7F\u7528\u6307\u5357","description":"","frontmatter":{},"headers":[{"level":2,"title":"\u9519\u8BEF\u6355\u83B7","slug":"\u9519\u8BEF\u6355\u83B7","link":"#\u9519\u8BEF\u6355\u83B7","children":[{"level":3,"title":"\u81EA\u52A8\u9519\u8BEF\u6355\u83B7","slug":"\u81EA\u52A8\u9519\u8BEF\u6355\u83B7","link":"#\u81EA\u52A8\u9519\u8BEF\u6355\u83B7","children":[]},{"level":3,"title":"\u624B\u52A8\u9519\u8BEF\u6355\u83B7","slug":"\u624B\u52A8\u9519\u8BEF\u6355\u83B7","link":"#\u624B\u52A8\u9519\u8BEF\u6355\u83B7","children":[]}]},{"level":2,"title":"\u9519\u8BEF\u7EA7\u522B","slug":"\u9519\u8BEF\u7EA7\u522B","link":"#\u9519\u8BEF\u7EA7\u522B","children":[]},{"level":2,"title":"\u4E0A\u4E0B\u6587\u4FE1\u606F","slug":"\u4E0A\u4E0B\u6587\u4FE1\u606F","link":"#\u4E0A\u4E0B\u6587\u4FE1\u606F","children":[{"level":3,"title":"\u7528\u6237\u4FE1\u606F","slug":"\u7528\u6237\u4FE1\u606F","link":"#\u7528\u6237\u4FE1\u606F","children":[]},{"level":3,"title":"\u6807\u7B7E\u548C\u989D\u5916\u6570\u636E","slug":"\u6807\u7B7E\u548C\u989D\u5916\u6570\u636E","link":"#\u6807\u7B7E\u548C\u989D\u5916\u6570\u636E","children":[]},{"level":3,"title":"\u9762\u5305\u5C51\u5BFC\u822A","slug":"\u9762\u5305\u5C51\u5BFC\u822A","link":"#\u9762\u5305\u5C51\u5BFC\u822A","children":[]}]},{"level":2,"title":"\u9519\u8BEF\u8FC7\u6EE4\u548C\u91C7\u6837","slug":"\u9519\u8BEF\u8FC7\u6EE4\u548C\u91C7\u6837","link":"#\u9519\u8BEF\u8FC7\u6EE4\u548C\u91C7\u6837","children":[{"level":3,"title":"\u9519\u8BEF\u8FC7\u6EE4","slug":"\u9519\u8BEF\u8FC7\u6EE4","link":"#\u9519\u8BEF\u8FC7\u6EE4","children":[]},{"level":3,"title":"\u91C7\u6837\u914D\u7F6E","slug":"\u91C7\u6837\u914D\u7F6E","link":"#\u91C7\u6837\u914D\u7F6E","children":[]}]},{"level":2,"title":"\u6027\u80FD\u76D1\u63A7","slug":"\u6027\u80FD\u76D1\u63A7","link":"#\u6027\u80FD\u76D1\u63A7","children":[{"level":3,"title":"\u6027\u80FD\u6307\u6807\u6536\u96C6","slug":"\u6027\u80FD\u6307\u6807\u6536\u96C6","link":"#\u6027\u80FD\u6307\u6807\u6536\u96C6","children":[]},{"level":3,"title":"\u81EA\u5B9A\u4E49\u6027\u80FD\u76D1\u63A7","slug":"\u81EA\u5B9A\u4E49\u6027\u80FD\u76D1\u63A7","link":"#\u81EA\u5B9A\u4E49\u6027\u80FD\u76D1\u63A7","children":[]}]},{"level":2,"title":"\u96C6\u6210\u7B2C\u4E09\u65B9\u670D\u52A1","slug":"\u96C6\u6210\u7B2C\u4E09\u65B9\u670D\u52A1","link":"#\u96C6\u6210\u7B2C\u4E09\u65B9\u670D\u52A1","children":[{"level":3,"title":"\u4E0E\u65E5\u5FD7\u670D\u52A1\u96C6\u6210","slug":"\u4E0E\u65E5\u5FD7\u670D\u52A1\u96C6\u6210","link":"#\u4E0E\u65E5\u5FD7\u670D\u52A1\u96C6\u6210","children":[]}]},{"level":2,"title":"\u8C03\u8BD5\u548C\u6D4B\u8BD5","slug":"\u8C03\u8BD5\u548C\u6D4B\u8BD5","link":"#\u8C03\u8BD5\u548C\u6D4B\u8BD5","children":[{"level":3,"title":"\u8C03\u8BD5\u6A21\u5F0F","slug":"\u8C03\u8BD5\u6A21\u5F0F","link":"#\u8C03\u8BD5\u6A21\u5F0F","children":[]},{"level":3,"title":"\u6D4B\u8BD5\u9519\u8BEF\u5904\u7406","slug":"\u6D4B\u8BD5\u9519\u8BEF\u5904\u7406","link":"#\u6D4B\u8BD5\u9519\u8BEF\u5904\u7406","children":[]}]},{"level":2,"title":"\u6700\u4F73\u5B9E\u8DF5","slug":"\u6700\u4F73\u5B9E\u8DF5","link":"#\u6700\u4F73\u5B9E\u8DF5","children":[{"level":3,"title":"1. \u5408\u7406\u8BBE\u7F6E\u9519\u8BEF\u7EA7\u522B","slug":"_1-\u5408\u7406\u8BBE\u7F6E\u9519\u8BEF\u7EA7\u522B","link":"#_1-\u5408\u7406\u8BBE\u7F6E\u9519\u8BEF\u7EA7\u522B","children":[]},{"level":3,"title":"2. \u63D0\u4F9B\u6709\u7528\u7684\u4E0A\u4E0B\u6587","slug":"_2-\u63D0\u4F9B\u6709\u7528\u7684\u4E0A\u4E0B\u6587","link":"#_2-\u63D0\u4F9B\u6709\u7528\u7684\u4E0A\u4E0B\u6587","children":[]},{"level":3,"title":"3. \u907F\u514D\u654F\u611F\u4FE1\u606F\u6CC4\u9732","slug":"_3-\u907F\u514D\u654F\u611F\u4FE1\u606F\u6CC4\u9732","link":"#_3-\u907F\u514D\u654F\u611F\u4FE1\u606F\u6CC4\u9732","children":[]},{"level":3,"title":"4. \u5408\u7406\u4F7F\u7528\u91C7\u6837","slug":"_4-\u5408\u7406\u4F7F\u7528\u91C7\u6837","link":"#_4-\u5408\u7406\u4F7F\u7528\u91C7\u6837","children":[]}]}],"relativePath":"docs/guide.md"}'),p={name:"docs/guide.md"},o=l(`<h1 id="\u4F7F\u7528\u6307\u5357" tabindex="-1">\u4F7F\u7528\u6307\u5357 <a class="header-anchor" href="#\u4F7F\u7528\u6307\u5357" aria-hidden="true">#</a></h1><p>\u672C\u6307\u5357\u5C06\u8BE6\u7EC6\u4ECB\u7ECDZError\u7684\u5404\u79CD\u529F\u80FD\u548C\u4F7F\u7528\u65B9\u6CD5\u3002</p><h2 id="\u9519\u8BEF\u6355\u83B7" tabindex="-1">\u9519\u8BEF\u6355\u83B7 <a class="header-anchor" href="#\u9519\u8BEF\u6355\u83B7" aria-hidden="true">#</a></h2><h3 id="\u81EA\u52A8\u9519\u8BEF\u6355\u83B7" tabindex="-1">\u81EA\u52A8\u9519\u8BEF\u6355\u83B7 <a class="header-anchor" href="#\u81EA\u52A8\u9519\u8BEF\u6355\u83B7" aria-hidden="true">#</a></h3><p>ZError \u4F1A\u81EA\u52A8\u6355\u83B7\u4EE5\u4E0B\u7C7B\u578B\u7684\u9519\u8BEF\uFF1A</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#8B949E;">// 1. JavaScript \u8FD0\u884C\u65F6\u9519\u8BEF</span></span>
<span class="line"><span style="color:#FF7B72;">function</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">buggyFunction</span><span style="color:#C9D1D9;">() {</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">throw</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">new</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">Error</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&#39;\u8FD9\u662F\u4E00\u4E2A\u8FD0\u884C\u65F6\u9519\u8BEF&#39;</span><span style="color:#C9D1D9;">);</span></span>
<span class="line"><span style="color:#C9D1D9;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">// 2. Promise \u672A\u5904\u7406\u7684\u62D2\u7EDD</span></span>
<span class="line"><span style="color:#79C0FF;">Promise</span><span style="color:#C9D1D9;">.</span><span style="color:#D2A8FF;">reject</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&#39;Promise \u88AB\u62D2\u7EDD\u4E86&#39;</span><span style="color:#C9D1D9;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">// 3. \u5F02\u6B65\u51FD\u6570\u9519\u8BEF</span></span>
<span class="line"><span style="color:#FF7B72;">async</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">function</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">asyncError</span><span style="color:#C9D1D9;">() {</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">throw</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">new</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">Error</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&#39;\u5F02\u6B65\u51FD\u6570\u9519\u8BEF&#39;</span><span style="color:#C9D1D9;">);</span></span>
<span class="line"><span style="color:#C9D1D9;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">// 4. \u7F51\u7EDC\u8BF7\u6C42\u9519\u8BEF</span></span>
<span class="line"><span style="color:#D2A8FF;">fetch</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&#39;/api/nonexistent&#39;</span><span style="color:#C9D1D9;">)</span></span>
<span class="line"><span style="color:#C9D1D9;">  .</span><span style="color:#D2A8FF;">then</span><span style="color:#C9D1D9;">(</span><span style="color:#FFA657;">response</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (</span><span style="color:#FF7B72;">!</span><span style="color:#C9D1D9;">response.ok) {</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">throw</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">new</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">Error</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&#39;\u7F51\u7EDC\u8BF7\u6C42\u5931\u8D25&#39;</span><span style="color:#C9D1D9;">);</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#C9D1D9;">  });</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#6E7781;">// 1. JavaScript \u8FD0\u884C\u65F6\u9519\u8BEF</span></span>
<span class="line"><span style="color:#CF222E;">function</span><span style="color:#24292F;"> </span><span style="color:#8250DF;">buggyFunction</span><span style="color:#24292F;">() {</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#CF222E;">throw</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">new</span><span style="color:#24292F;"> </span><span style="color:#8250DF;">Error</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">&#39;\u8FD9\u662F\u4E00\u4E2A\u8FD0\u884C\u65F6\u9519\u8BEF&#39;</span><span style="color:#24292F;">);</span></span>
<span class="line"><span style="color:#24292F;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6E7781;">// 2. Promise \u672A\u5904\u7406\u7684\u62D2\u7EDD</span></span>
<span class="line"><span style="color:#0550AE;">Promise</span><span style="color:#24292F;">.</span><span style="color:#8250DF;">reject</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">&#39;Promise \u88AB\u62D2\u7EDD\u4E86&#39;</span><span style="color:#24292F;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6E7781;">// 3. \u5F02\u6B65\u51FD\u6570\u9519\u8BEF</span></span>
<span class="line"><span style="color:#CF222E;">async</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">function</span><span style="color:#24292F;"> </span><span style="color:#8250DF;">asyncError</span><span style="color:#24292F;">() {</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#CF222E;">throw</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">new</span><span style="color:#24292F;"> </span><span style="color:#8250DF;">Error</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">&#39;\u5F02\u6B65\u51FD\u6570\u9519\u8BEF&#39;</span><span style="color:#24292F;">);</span></span>
<span class="line"><span style="color:#24292F;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6E7781;">// 4. \u7F51\u7EDC\u8BF7\u6C42\u9519\u8BEF</span></span>
<span class="line"><span style="color:#8250DF;">fetch</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">&#39;/api/nonexistent&#39;</span><span style="color:#24292F;">)</span></span>
<span class="line"><span style="color:#24292F;">  .</span><span style="color:#8250DF;">then</span><span style="color:#24292F;">(</span><span style="color:#953800;">response</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=&gt;</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#CF222E;">if</span><span style="color:#24292F;"> (</span><span style="color:#CF222E;">!</span><span style="color:#24292F;">response.ok) {</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#CF222E;">throw</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">new</span><span style="color:#24292F;"> </span><span style="color:#8250DF;">Error</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">&#39;\u7F51\u7EDC\u8BF7\u6C42\u5931\u8D25&#39;</span><span style="color:#24292F;">);</span></span>
<span class="line"><span style="color:#24292F;">    }</span></span>
<span class="line"><span style="color:#24292F;">  });</span></span>
<span class="line"></span></code></pre></div><h3 id="\u624B\u52A8\u9519\u8BEF\u6355\u83B7" tabindex="-1">\u624B\u52A8\u9519\u8BEF\u6355\u83B7 <a class="header-anchor" href="#\u624B\u52A8\u9519\u8BEF\u6355\u83B7" aria-hidden="true">#</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#8B949E;">// \u6355\u83B7\u5F02\u5E38\u5BF9\u8C61</span></span>
<span class="line"><span style="color:#FF7B72;">try</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#D2A8FF;">riskyOperation</span><span style="color:#C9D1D9;">();</span></span>
<span class="line"><span style="color:#C9D1D9;">} </span><span style="color:#FF7B72;">catch</span><span style="color:#C9D1D9;"> (error) {</span></span>
<span class="line"><span style="color:#C9D1D9;">  errorHandler.</span><span style="color:#D2A8FF;">captureError</span><span style="color:#C9D1D9;">(error, {</span></span>
<span class="line"><span style="color:#C9D1D9;">    level: </span><span style="color:#A5D6FF;">&#39;error&#39;</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">    tags: { section: </span><span style="color:#A5D6FF;">&#39;payment&#39;</span><span style="color:#C9D1D9;"> },</span></span>
<span class="line"><span style="color:#C9D1D9;">    extra: { userId: </span><span style="color:#A5D6FF;">&#39;12345&#39;</span><span style="color:#C9D1D9;"> }</span></span>
<span class="line"><span style="color:#C9D1D9;">  });</span></span>
<span class="line"><span style="color:#C9D1D9;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">// \u6355\u83B7\u5B57\u7B26\u4E32\u6D88\u606F</span></span>
<span class="line"><span style="color:#C9D1D9;">errorHandler.</span><span style="color:#D2A8FF;">captureMessage</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&#39;\u7528\u6237\u6267\u884C\u4E86\u65E0\u6548\u64CD\u4F5C&#39;</span><span style="color:#C9D1D9;">, </span><span style="color:#A5D6FF;">&#39;warning&#39;</span><span style="color:#C9D1D9;">, {</span></span>
<span class="line"><span style="color:#C9D1D9;">  user: { id: </span><span style="color:#A5D6FF;">&#39;12345&#39;</span><span style="color:#C9D1D9;">, name: </span><span style="color:#A5D6FF;">&#39;John&#39;</span><span style="color:#C9D1D9;"> },</span></span>
<span class="line"><span style="color:#C9D1D9;">  extra: { action: </span><span style="color:#A5D6FF;">&#39;invalid_click&#39;</span><span style="color:#C9D1D9;"> }</span></span>
<span class="line"><span style="color:#C9D1D9;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">// \u6355\u83B7\u81EA\u5B9A\u4E49\u9519\u8BEF</span></span>
<span class="line"><span style="color:#C9D1D9;">errorHandler.</span><span style="color:#D2A8FF;">captureError</span><span style="color:#C9D1D9;">(</span><span style="color:#FF7B72;">new</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">Error</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&#39;\u81EA\u5B9A\u4E49\u9519\u8BEF&#39;</span><span style="color:#C9D1D9;">), {</span></span>
<span class="line"><span style="color:#C9D1D9;">  fingerprint: [</span><span style="color:#A5D6FF;">&#39;custom-error&#39;</span><span style="color:#C9D1D9;">, </span><span style="color:#A5D6FF;">&#39;payment-module&#39;</span><span style="color:#C9D1D9;">],</span></span>
<span class="line"><span style="color:#C9D1D9;">  level: </span><span style="color:#A5D6FF;">&#39;fatal&#39;</span></span>
<span class="line"><span style="color:#C9D1D9;">});</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#6E7781;">// \u6355\u83B7\u5F02\u5E38\u5BF9\u8C61</span></span>
<span class="line"><span style="color:#CF222E;">try</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#8250DF;">riskyOperation</span><span style="color:#24292F;">();</span></span>
<span class="line"><span style="color:#24292F;">} </span><span style="color:#CF222E;">catch</span><span style="color:#24292F;"> (error) {</span></span>
<span class="line"><span style="color:#24292F;">  errorHandler.</span><span style="color:#8250DF;">captureError</span><span style="color:#24292F;">(error, {</span></span>
<span class="line"><span style="color:#24292F;">    level: </span><span style="color:#0A3069;">&#39;error&#39;</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">    tags: { section: </span><span style="color:#0A3069;">&#39;payment&#39;</span><span style="color:#24292F;"> },</span></span>
<span class="line"><span style="color:#24292F;">    extra: { userId: </span><span style="color:#0A3069;">&#39;12345&#39;</span><span style="color:#24292F;"> }</span></span>
<span class="line"><span style="color:#24292F;">  });</span></span>
<span class="line"><span style="color:#24292F;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6E7781;">// \u6355\u83B7\u5B57\u7B26\u4E32\u6D88\u606F</span></span>
<span class="line"><span style="color:#24292F;">errorHandler.</span><span style="color:#8250DF;">captureMessage</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">&#39;\u7528\u6237\u6267\u884C\u4E86\u65E0\u6548\u64CD\u4F5C&#39;</span><span style="color:#24292F;">, </span><span style="color:#0A3069;">&#39;warning&#39;</span><span style="color:#24292F;">, {</span></span>
<span class="line"><span style="color:#24292F;">  user: { id: </span><span style="color:#0A3069;">&#39;12345&#39;</span><span style="color:#24292F;">, name: </span><span style="color:#0A3069;">&#39;John&#39;</span><span style="color:#24292F;"> },</span></span>
<span class="line"><span style="color:#24292F;">  extra: { action: </span><span style="color:#0A3069;">&#39;invalid_click&#39;</span><span style="color:#24292F;"> }</span></span>
<span class="line"><span style="color:#24292F;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6E7781;">// \u6355\u83B7\u81EA\u5B9A\u4E49\u9519\u8BEF</span></span>
<span class="line"><span style="color:#24292F;">errorHandler.</span><span style="color:#8250DF;">captureError</span><span style="color:#24292F;">(</span><span style="color:#CF222E;">new</span><span style="color:#24292F;"> </span><span style="color:#8250DF;">Error</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">&#39;\u81EA\u5B9A\u4E49\u9519\u8BEF&#39;</span><span style="color:#24292F;">), {</span></span>
<span class="line"><span style="color:#24292F;">  fingerprint: [</span><span style="color:#0A3069;">&#39;custom-error&#39;</span><span style="color:#24292F;">, </span><span style="color:#0A3069;">&#39;payment-module&#39;</span><span style="color:#24292F;">],</span></span>
<span class="line"><span style="color:#24292F;">  level: </span><span style="color:#0A3069;">&#39;fatal&#39;</span></span>
<span class="line"><span style="color:#24292F;">});</span></span>
<span class="line"></span></code></pre></div><h2 id="\u9519\u8BEF\u7EA7\u522B" tabindex="-1">\u9519\u8BEF\u7EA7\u522B <a class="header-anchor" href="#\u9519\u8BEF\u7EA7\u522B" aria-hidden="true">#</a></h2><p>ZError \u652F\u6301\u591A\u79CD\u9519\u8BEF\u7EA7\u522B\uFF1A</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#8B949E;">// \u81F4\u547D\u9519\u8BEF - \u5E94\u7528\u5D29\u6E83\u7EA7\u522B</span></span>
<span class="line"><span style="color:#C9D1D9;">errorHandler.</span><span style="color:#D2A8FF;">captureMessage</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&#39;\u5E94\u7528\u5D29\u6E83&#39;</span><span style="color:#C9D1D9;">, </span><span style="color:#A5D6FF;">&#39;fatal&#39;</span><span style="color:#C9D1D9;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">// \u9519\u8BEF - \u529F\u80FD\u65E0\u6CD5\u6B63\u5E38\u5DE5\u4F5C</span></span>
<span class="line"><span style="color:#C9D1D9;">errorHandler.</span><span style="color:#D2A8FF;">captureMessage</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&#39;\u652F\u4ED8\u5931\u8D25&#39;</span><span style="color:#C9D1D9;">, </span><span style="color:#A5D6FF;">&#39;error&#39;</span><span style="color:#C9D1D9;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">// \u8B66\u544A - \u6F5C\u5728\u95EE\u9898</span></span>
<span class="line"><span style="color:#C9D1D9;">errorHandler.</span><span style="color:#D2A8FF;">captureMessage</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&#39;API\u54CD\u5E94\u7F13\u6162&#39;</span><span style="color:#C9D1D9;">, </span><span style="color:#A5D6FF;">&#39;warning&#39;</span><span style="color:#C9D1D9;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">// \u4FE1\u606F - \u4E00\u822C\u4FE1\u606F</span></span>
<span class="line"><span style="color:#C9D1D9;">errorHandler.</span><span style="color:#D2A8FF;">captureMessage</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&#39;\u7528\u6237\u767B\u5F55&#39;</span><span style="color:#C9D1D9;">, </span><span style="color:#A5D6FF;">&#39;info&#39;</span><span style="color:#C9D1D9;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">// \u8C03\u8BD5 - \u8C03\u8BD5\u4FE1\u606F</span></span>
<span class="line"><span style="color:#C9D1D9;">errorHandler.</span><span style="color:#D2A8FF;">captureMessage</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&#39;\u8C03\u8BD5\u4FE1\u606F&#39;</span><span style="color:#C9D1D9;">, </span><span style="color:#A5D6FF;">&#39;debug&#39;</span><span style="color:#C9D1D9;">);</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#6E7781;">// \u81F4\u547D\u9519\u8BEF - \u5E94\u7528\u5D29\u6E83\u7EA7\u522B</span></span>
<span class="line"><span style="color:#24292F;">errorHandler.</span><span style="color:#8250DF;">captureMessage</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">&#39;\u5E94\u7528\u5D29\u6E83&#39;</span><span style="color:#24292F;">, </span><span style="color:#0A3069;">&#39;fatal&#39;</span><span style="color:#24292F;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6E7781;">// \u9519\u8BEF - \u529F\u80FD\u65E0\u6CD5\u6B63\u5E38\u5DE5\u4F5C</span></span>
<span class="line"><span style="color:#24292F;">errorHandler.</span><span style="color:#8250DF;">captureMessage</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">&#39;\u652F\u4ED8\u5931\u8D25&#39;</span><span style="color:#24292F;">, </span><span style="color:#0A3069;">&#39;error&#39;</span><span style="color:#24292F;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6E7781;">// \u8B66\u544A - \u6F5C\u5728\u95EE\u9898</span></span>
<span class="line"><span style="color:#24292F;">errorHandler.</span><span style="color:#8250DF;">captureMessage</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">&#39;API\u54CD\u5E94\u7F13\u6162&#39;</span><span style="color:#24292F;">, </span><span style="color:#0A3069;">&#39;warning&#39;</span><span style="color:#24292F;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6E7781;">// \u4FE1\u606F - \u4E00\u822C\u4FE1\u606F</span></span>
<span class="line"><span style="color:#24292F;">errorHandler.</span><span style="color:#8250DF;">captureMessage</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">&#39;\u7528\u6237\u767B\u5F55&#39;</span><span style="color:#24292F;">, </span><span style="color:#0A3069;">&#39;info&#39;</span><span style="color:#24292F;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6E7781;">// \u8C03\u8BD5 - \u8C03\u8BD5\u4FE1\u606F</span></span>
<span class="line"><span style="color:#24292F;">errorHandler.</span><span style="color:#8250DF;">captureMessage</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">&#39;\u8C03\u8BD5\u4FE1\u606F&#39;</span><span style="color:#24292F;">, </span><span style="color:#0A3069;">&#39;debug&#39;</span><span style="color:#24292F;">);</span></span>
<span class="line"></span></code></pre></div><h2 id="\u4E0A\u4E0B\u6587\u4FE1\u606F" tabindex="-1">\u4E0A\u4E0B\u6587\u4FE1\u606F <a class="header-anchor" href="#\u4E0A\u4E0B\u6587\u4FE1\u606F" aria-hidden="true">#</a></h2><h3 id="\u7528\u6237\u4FE1\u606F" tabindex="-1">\u7528\u6237\u4FE1\u606F <a class="header-anchor" href="#\u7528\u6237\u4FE1\u606F" aria-hidden="true">#</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#8B949E;">// \u8BBE\u7F6E\u7528\u6237\u4FE1\u606F</span></span>
<span class="line"><span style="color:#C9D1D9;">errorHandler.</span><span style="color:#D2A8FF;">setUser</span><span style="color:#C9D1D9;">({</span></span>
<span class="line"><span style="color:#C9D1D9;">  id: </span><span style="color:#A5D6FF;">&#39;12345&#39;</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">  email: </span><span style="color:#A5D6FF;">&#39;user@example.com&#39;</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">  username: </span><span style="color:#A5D6FF;">&#39;john_doe&#39;</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">  name: </span><span style="color:#A5D6FF;">&#39;John Doe&#39;</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">  ip_address: </span><span style="color:#A5D6FF;">&#39;192.168.1.1&#39;</span></span>
<span class="line"><span style="color:#C9D1D9;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">// \u66F4\u65B0\u7528\u6237\u4FE1\u606F</span></span>
<span class="line"><span style="color:#C9D1D9;">errorHandler.</span><span style="color:#D2A8FF;">setUser</span><span style="color:#C9D1D9;">({ id: </span><span style="color:#A5D6FF;">&#39;67890&#39;</span><span style="color:#C9D1D9;"> });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">// \u6E05\u9664\u7528\u6237\u4FE1\u606F</span></span>
<span class="line"><span style="color:#C9D1D9;">errorHandler.</span><span style="color:#D2A8FF;">setUser</span><span style="color:#C9D1D9;">(</span><span style="color:#79C0FF;">null</span><span style="color:#C9D1D9;">);</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#6E7781;">// \u8BBE\u7F6E\u7528\u6237\u4FE1\u606F</span></span>
<span class="line"><span style="color:#24292F;">errorHandler.</span><span style="color:#8250DF;">setUser</span><span style="color:#24292F;">({</span></span>
<span class="line"><span style="color:#24292F;">  id: </span><span style="color:#0A3069;">&#39;12345&#39;</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">  email: </span><span style="color:#0A3069;">&#39;user@example.com&#39;</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">  username: </span><span style="color:#0A3069;">&#39;john_doe&#39;</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">  name: </span><span style="color:#0A3069;">&#39;John Doe&#39;</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">  ip_address: </span><span style="color:#0A3069;">&#39;192.168.1.1&#39;</span></span>
<span class="line"><span style="color:#24292F;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6E7781;">// \u66F4\u65B0\u7528\u6237\u4FE1\u606F</span></span>
<span class="line"><span style="color:#24292F;">errorHandler.</span><span style="color:#8250DF;">setUser</span><span style="color:#24292F;">({ id: </span><span style="color:#0A3069;">&#39;67890&#39;</span><span style="color:#24292F;"> });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6E7781;">// \u6E05\u9664\u7528\u6237\u4FE1\u606F</span></span>
<span class="line"><span style="color:#24292F;">errorHandler.</span><span style="color:#8250DF;">setUser</span><span style="color:#24292F;">(</span><span style="color:#0550AE;">null</span><span style="color:#24292F;">);</span></span>
<span class="line"></span></code></pre></div><h3 id="\u6807\u7B7E\u548C\u989D\u5916\u6570\u636E" tabindex="-1">\u6807\u7B7E\u548C\u989D\u5916\u6570\u636E <a class="header-anchor" href="#\u6807\u7B7E\u548C\u989D\u5916\u6570\u636E" aria-hidden="true">#</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#8B949E;">// \u8BBE\u7F6E\u5168\u5C40\u6807\u7B7E</span></span>
<span class="line"><span style="color:#C9D1D9;">errorHandler.</span><span style="color:#D2A8FF;">setTags</span><span style="color:#C9D1D9;">({</span></span>
<span class="line"><span style="color:#C9D1D9;">  environment: </span><span style="color:#A5D6FF;">&#39;production&#39;</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">  version: </span><span style="color:#A5D6FF;">&#39;1.2.3&#39;</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">  feature: </span><span style="color:#A5D6FF;">&#39;checkout&#39;</span></span>
<span class="line"><span style="color:#C9D1D9;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">// \u8BBE\u7F6E\u989D\u5916\u6570\u636E</span></span>
<span class="line"><span style="color:#C9D1D9;">errorHandler.</span><span style="color:#D2A8FF;">setExtra</span><span style="color:#C9D1D9;">({</span></span>
<span class="line"><span style="color:#C9D1D9;">  buildNumber: </span><span style="color:#A5D6FF;">&#39;12345&#39;</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">  gitCommit: </span><span style="color:#A5D6FF;">&#39;abc123&#39;</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">  serverRegion: </span><span style="color:#A5D6FF;">&#39;us-east-1&#39;</span></span>
<span class="line"><span style="color:#C9D1D9;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">// \u5728\u6355\u83B7\u9519\u8BEF\u65F6\u6DFB\u52A0\u7279\u5B9A\u4E0A\u4E0B\u6587</span></span>
<span class="line"><span style="color:#C9D1D9;">errorHandler.</span><span style="color:#D2A8FF;">captureError</span><span style="color:#C9D1D9;">(error, {</span></span>
<span class="line"><span style="color:#C9D1D9;">  tags: { component: </span><span style="color:#A5D6FF;">&#39;payment-form&#39;</span><span style="color:#C9D1D9;"> },</span></span>
<span class="line"><span style="color:#C9D1D9;">  extra: { </span></span>
<span class="line"><span style="color:#C9D1D9;">    formData: { amount: </span><span style="color:#79C0FF;">100</span><span style="color:#C9D1D9;">, currency: </span><span style="color:#A5D6FF;">&#39;USD&#39;</span><span style="color:#C9D1D9;"> },</span></span>
<span class="line"><span style="color:#C9D1D9;">    timestamp: Date.</span><span style="color:#D2A8FF;">now</span><span style="color:#C9D1D9;">()</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"><span style="color:#C9D1D9;">});</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#6E7781;">// \u8BBE\u7F6E\u5168\u5C40\u6807\u7B7E</span></span>
<span class="line"><span style="color:#24292F;">errorHandler.</span><span style="color:#8250DF;">setTags</span><span style="color:#24292F;">({</span></span>
<span class="line"><span style="color:#24292F;">  environment: </span><span style="color:#0A3069;">&#39;production&#39;</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">  version: </span><span style="color:#0A3069;">&#39;1.2.3&#39;</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">  feature: </span><span style="color:#0A3069;">&#39;checkout&#39;</span></span>
<span class="line"><span style="color:#24292F;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6E7781;">// \u8BBE\u7F6E\u989D\u5916\u6570\u636E</span></span>
<span class="line"><span style="color:#24292F;">errorHandler.</span><span style="color:#8250DF;">setExtra</span><span style="color:#24292F;">({</span></span>
<span class="line"><span style="color:#24292F;">  buildNumber: </span><span style="color:#0A3069;">&#39;12345&#39;</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">  gitCommit: </span><span style="color:#0A3069;">&#39;abc123&#39;</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">  serverRegion: </span><span style="color:#0A3069;">&#39;us-east-1&#39;</span></span>
<span class="line"><span style="color:#24292F;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6E7781;">// \u5728\u6355\u83B7\u9519\u8BEF\u65F6\u6DFB\u52A0\u7279\u5B9A\u4E0A\u4E0B\u6587</span></span>
<span class="line"><span style="color:#24292F;">errorHandler.</span><span style="color:#8250DF;">captureError</span><span style="color:#24292F;">(error, {</span></span>
<span class="line"><span style="color:#24292F;">  tags: { component: </span><span style="color:#0A3069;">&#39;payment-form&#39;</span><span style="color:#24292F;"> },</span></span>
<span class="line"><span style="color:#24292F;">  extra: { </span></span>
<span class="line"><span style="color:#24292F;">    formData: { amount: </span><span style="color:#0550AE;">100</span><span style="color:#24292F;">, currency: </span><span style="color:#0A3069;">&#39;USD&#39;</span><span style="color:#24292F;"> },</span></span>
<span class="line"><span style="color:#24292F;">    timestamp: Date.</span><span style="color:#8250DF;">now</span><span style="color:#24292F;">()</span></span>
<span class="line"><span style="color:#24292F;">  }</span></span>
<span class="line"><span style="color:#24292F;">});</span></span>
<span class="line"></span></code></pre></div><h3 id="\u9762\u5305\u5C51\u5BFC\u822A" tabindex="-1">\u9762\u5305\u5C51\u5BFC\u822A <a class="header-anchor" href="#\u9762\u5305\u5C51\u5BFC\u822A" aria-hidden="true">#</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#8B949E;">// \u6DFB\u52A0\u9762\u5305\u5C51</span></span>
<span class="line"><span style="color:#C9D1D9;">errorHandler.</span><span style="color:#D2A8FF;">addBreadcrumb</span><span style="color:#C9D1D9;">({</span></span>
<span class="line"><span style="color:#C9D1D9;">  message: </span><span style="color:#A5D6FF;">&#39;\u7528\u6237\u70B9\u51FB\u4E86\u652F\u4ED8\u6309\u94AE&#39;</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">  category: </span><span style="color:#A5D6FF;">&#39;ui.click&#39;</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">  level: </span><span style="color:#A5D6FF;">&#39;info&#39;</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">  data: {</span></span>
<span class="line"><span style="color:#C9D1D9;">    element: </span><span style="color:#A5D6FF;">&#39;pay-button&#39;</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">    amount: </span><span style="color:#79C0FF;">100</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"><span style="color:#C9D1D9;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">// \u81EA\u52A8\u9762\u5305\u5C51\uFF08\u9700\u8981\u542F\u7528\uFF09</span></span>
<span class="line"><span style="color:#C9D1D9;">errorHandler.</span><span style="color:#D2A8FF;">configure</span><span style="color:#C9D1D9;">({</span></span>
<span class="line"><span style="color:#C9D1D9;">  autoBreadcrumbs: {</span></span>
<span class="line"><span style="color:#C9D1D9;">    console: </span><span style="color:#79C0FF;">true</span><span style="color:#C9D1D9;">,    </span><span style="color:#8B949E;">// \u63A7\u5236\u53F0\u8F93\u51FA</span></span>
<span class="line"><span style="color:#C9D1D9;">    dom: </span><span style="color:#79C0FF;">true</span><span style="color:#C9D1D9;">,        </span><span style="color:#8B949E;">// DOM \u4E8B\u4EF6</span></span>
<span class="line"><span style="color:#C9D1D9;">    xhr: </span><span style="color:#79C0FF;">true</span><span style="color:#C9D1D9;">,        </span><span style="color:#8B949E;">// XHR \u8BF7\u6C42</span></span>
<span class="line"><span style="color:#C9D1D9;">    location: </span><span style="color:#79C0FF;">true</span><span style="color:#C9D1D9;">,   </span><span style="color:#8B949E;">// \u9875\u9762\u5BFC\u822A</span></span>
<span class="line"><span style="color:#C9D1D9;">    history: </span><span style="color:#79C0FF;">true</span><span style="color:#C9D1D9;">     </span><span style="color:#8B949E;">// \u5386\u53F2\u8BB0\u5F55\u53D8\u5316</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"><span style="color:#C9D1D9;">});</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#6E7781;">// \u6DFB\u52A0\u9762\u5305\u5C51</span></span>
<span class="line"><span style="color:#24292F;">errorHandler.</span><span style="color:#8250DF;">addBreadcrumb</span><span style="color:#24292F;">({</span></span>
<span class="line"><span style="color:#24292F;">  message: </span><span style="color:#0A3069;">&#39;\u7528\u6237\u70B9\u51FB\u4E86\u652F\u4ED8\u6309\u94AE&#39;</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">  category: </span><span style="color:#0A3069;">&#39;ui.click&#39;</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">  level: </span><span style="color:#0A3069;">&#39;info&#39;</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">  data: {</span></span>
<span class="line"><span style="color:#24292F;">    element: </span><span style="color:#0A3069;">&#39;pay-button&#39;</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">    amount: </span><span style="color:#0550AE;">100</span></span>
<span class="line"><span style="color:#24292F;">  }</span></span>
<span class="line"><span style="color:#24292F;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6E7781;">// \u81EA\u52A8\u9762\u5305\u5C51\uFF08\u9700\u8981\u542F\u7528\uFF09</span></span>
<span class="line"><span style="color:#24292F;">errorHandler.</span><span style="color:#8250DF;">configure</span><span style="color:#24292F;">({</span></span>
<span class="line"><span style="color:#24292F;">  autoBreadcrumbs: {</span></span>
<span class="line"><span style="color:#24292F;">    console: </span><span style="color:#0550AE;">true</span><span style="color:#24292F;">,    </span><span style="color:#6E7781;">// \u63A7\u5236\u53F0\u8F93\u51FA</span></span>
<span class="line"><span style="color:#24292F;">    dom: </span><span style="color:#0550AE;">true</span><span style="color:#24292F;">,        </span><span style="color:#6E7781;">// DOM \u4E8B\u4EF6</span></span>
<span class="line"><span style="color:#24292F;">    xhr: </span><span style="color:#0550AE;">true</span><span style="color:#24292F;">,        </span><span style="color:#6E7781;">// XHR \u8BF7\u6C42</span></span>
<span class="line"><span style="color:#24292F;">    location: </span><span style="color:#0550AE;">true</span><span style="color:#24292F;">,   </span><span style="color:#6E7781;">// \u9875\u9762\u5BFC\u822A</span></span>
<span class="line"><span style="color:#24292F;">    history: </span><span style="color:#0550AE;">true</span><span style="color:#24292F;">     </span><span style="color:#6E7781;">// \u5386\u53F2\u8BB0\u5F55\u53D8\u5316</span></span>
<span class="line"><span style="color:#24292F;">  }</span></span>
<span class="line"><span style="color:#24292F;">});</span></span>
<span class="line"></span></code></pre></div><h2 id="\u9519\u8BEF\u8FC7\u6EE4\u548C\u91C7\u6837" tabindex="-1">\u9519\u8BEF\u8FC7\u6EE4\u548C\u91C7\u6837 <a class="header-anchor" href="#\u9519\u8BEF\u8FC7\u6EE4\u548C\u91C7\u6837" aria-hidden="true">#</a></h2><h3 id="\u9519\u8BEF\u8FC7\u6EE4" tabindex="-1">\u9519\u8BEF\u8FC7\u6EE4 <a class="header-anchor" href="#\u9519\u8BEF\u8FC7\u6EE4" aria-hidden="true">#</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">errorHandler</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">new</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">ZError</span><span style="color:#C9D1D9;">({</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// \u5FFD\u7565\u7279\u5B9A\u9519\u8BEF\u6D88\u606F</span></span>
<span class="line"><span style="color:#C9D1D9;">  ignoreErrors: [</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#A5D6FF;">&#39;Script error.&#39;</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#A5D6FF;">&#39;Non-Error promise rejection captured&#39;</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#A5D6FF;">/ResizeObserver loop limit exceeded/</span></span>
<span class="line"><span style="color:#C9D1D9;">  ],</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// \u5FFD\u7565\u7279\u5B9AURL\u7684\u9519\u8BEF</span></span>
<span class="line"><span style="color:#C9D1D9;">  ignoreUrls: [</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#A5D6FF;">/extensions</span><span style="color:#7EE787;font-style:italic;">\\/</span><span style="color:#A5D6FF;">/</span><span style="color:#FF7B72;">i</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#A5D6FF;">/</span><span style="color:#FF7B72;">^</span><span style="color:#A5D6FF;">chrome:</span><span style="color:#7EE787;font-style:italic;">\\/\\/</span><span style="color:#A5D6FF;">/</span><span style="color:#FF7B72;">i</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#A5D6FF;">&#39;https://example.com/ignore&#39;</span></span>
<span class="line"><span style="color:#C9D1D9;">  ],</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// \u81EA\u5B9A\u4E49\u8FC7\u6EE4\u51FD\u6570</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#D2A8FF;">beforeSend</span><span style="color:#C9D1D9;">: (</span><span style="color:#FFA657;">event</span><span style="color:#C9D1D9;">) </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#8B949E;">// \u8FC7\u6EE4\u6389\u5F00\u53D1\u73AF\u5883\u7684\u9519\u8BEF</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (event.environment </span><span style="color:#FF7B72;">===</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;development&#39;</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">null</span><span style="color:#C9D1D9;">;</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#8B949E;">// \u8FC7\u6EE4\u6389\u7279\u5B9A\u7528\u6237\u7684\u9519\u8BEF</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (event.user </span><span style="color:#FF7B72;">&amp;&amp;</span><span style="color:#C9D1D9;"> event.user.id </span><span style="color:#FF7B72;">===</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;test-user&#39;</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">null</span><span style="color:#C9D1D9;">;</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#8B949E;">// \u4FEE\u6539\u9519\u8BEF\u6570\u636E</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (event.exception) {</span></span>
<span class="line"><span style="color:#C9D1D9;">      event.exception.values.</span><span style="color:#D2A8FF;">forEach</span><span style="color:#C9D1D9;">(</span><span style="color:#FFA657;">exception</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">        exception.stacktrace.frames.</span><span style="color:#D2A8FF;">forEach</span><span style="color:#C9D1D9;">(</span><span style="color:#FFA657;">frame</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">          </span><span style="color:#8B949E;">// \u79FB\u9664\u654F\u611F\u4FE1\u606F</span></span>
<span class="line"><span style="color:#C9D1D9;">          </span><span style="color:#FF7B72;">delete</span><span style="color:#C9D1D9;"> frame.vars;</span></span>
<span class="line"><span style="color:#C9D1D9;">        });</span></span>
<span class="line"><span style="color:#C9D1D9;">      });</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> event;</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"><span style="color:#C9D1D9;">});</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#CF222E;">const</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">errorHandler</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">new</span><span style="color:#24292F;"> </span><span style="color:#8250DF;">ZError</span><span style="color:#24292F;">({</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#6E7781;">// \u5FFD\u7565\u7279\u5B9A\u9519\u8BEF\u6D88\u606F</span></span>
<span class="line"><span style="color:#24292F;">  ignoreErrors: [</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#0A3069;">&#39;Script error.&#39;</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#0A3069;">&#39;Non-Error promise rejection captured&#39;</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#0A3069;">/ResizeObserver loop limit exceeded/</span></span>
<span class="line"><span style="color:#24292F;">  ],</span></span>
<span class="line"><span style="color:#24292F;">  </span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#6E7781;">// \u5FFD\u7565\u7279\u5B9AURL\u7684\u9519\u8BEF</span></span>
<span class="line"><span style="color:#24292F;">  ignoreUrls: [</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#0A3069;">/extensions</span><span style="color:#116329;font-style:italic;">\\/</span><span style="color:#0A3069;">/</span><span style="color:#CF222E;">i</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#0A3069;">/</span><span style="color:#CF222E;">^</span><span style="color:#0A3069;">chrome:</span><span style="color:#116329;font-style:italic;">\\/\\/</span><span style="color:#0A3069;">/</span><span style="color:#CF222E;">i</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#0A3069;">&#39;https://example.com/ignore&#39;</span></span>
<span class="line"><span style="color:#24292F;">  ],</span></span>
<span class="line"><span style="color:#24292F;">  </span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#6E7781;">// \u81EA\u5B9A\u4E49\u8FC7\u6EE4\u51FD\u6570</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#8250DF;">beforeSend</span><span style="color:#24292F;">: (</span><span style="color:#953800;">event</span><span style="color:#24292F;">) </span><span style="color:#CF222E;">=&gt;</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#6E7781;">// \u8FC7\u6EE4\u6389\u5F00\u53D1\u73AF\u5883\u7684\u9519\u8BEF</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#CF222E;">if</span><span style="color:#24292F;"> (event.environment </span><span style="color:#CF222E;">===</span><span style="color:#24292F;"> </span><span style="color:#0A3069;">&#39;development&#39;</span><span style="color:#24292F;">) {</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#CF222E;">return</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">null</span><span style="color:#24292F;">;</span></span>
<span class="line"><span style="color:#24292F;">    }</span></span>
<span class="line"><span style="color:#24292F;">    </span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#6E7781;">// \u8FC7\u6EE4\u6389\u7279\u5B9A\u7528\u6237\u7684\u9519\u8BEF</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#CF222E;">if</span><span style="color:#24292F;"> (event.user </span><span style="color:#CF222E;">&amp;&amp;</span><span style="color:#24292F;"> event.user.id </span><span style="color:#CF222E;">===</span><span style="color:#24292F;"> </span><span style="color:#0A3069;">&#39;test-user&#39;</span><span style="color:#24292F;">) {</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#CF222E;">return</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">null</span><span style="color:#24292F;">;</span></span>
<span class="line"><span style="color:#24292F;">    }</span></span>
<span class="line"><span style="color:#24292F;">    </span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#6E7781;">// \u4FEE\u6539\u9519\u8BEF\u6570\u636E</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#CF222E;">if</span><span style="color:#24292F;"> (event.exception) {</span></span>
<span class="line"><span style="color:#24292F;">      event.exception.values.</span><span style="color:#8250DF;">forEach</span><span style="color:#24292F;">(</span><span style="color:#953800;">exception</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=&gt;</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">        exception.stacktrace.frames.</span><span style="color:#8250DF;">forEach</span><span style="color:#24292F;">(</span><span style="color:#953800;">frame</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=&gt;</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">          </span><span style="color:#6E7781;">// \u79FB\u9664\u654F\u611F\u4FE1\u606F</span></span>
<span class="line"><span style="color:#24292F;">          </span><span style="color:#CF222E;">delete</span><span style="color:#24292F;"> frame.vars;</span></span>
<span class="line"><span style="color:#24292F;">        });</span></span>
<span class="line"><span style="color:#24292F;">      });</span></span>
<span class="line"><span style="color:#24292F;">    }</span></span>
<span class="line"><span style="color:#24292F;">    </span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#CF222E;">return</span><span style="color:#24292F;"> event;</span></span>
<span class="line"><span style="color:#24292F;">  }</span></span>
<span class="line"><span style="color:#24292F;">});</span></span>
<span class="line"></span></code></pre></div><h3 id="\u91C7\u6837\u914D\u7F6E" tabindex="-1">\u91C7\u6837\u914D\u7F6E <a class="header-anchor" href="#\u91C7\u6837\u914D\u7F6E" aria-hidden="true">#</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">errorHandler</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">new</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">ZError</span><span style="color:#C9D1D9;">({</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// \u5168\u5C40\u91C7\u6837\u7387\uFF080-1\u4E4B\u95F4\uFF09</span></span>
<span class="line"><span style="color:#C9D1D9;">  sampleRate: </span><span style="color:#79C0FF;">0.1</span><span style="color:#C9D1D9;">, </span><span style="color:#8B949E;">// \u53EA\u91C7\u683710%\u7684\u9519\u8BEF</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// \u57FA\u4E8E\u9519\u8BEF\u7EA7\u522B\u7684\u91C7\u6837</span></span>
<span class="line"><span style="color:#C9D1D9;">  sampleRates: {</span></span>
<span class="line"><span style="color:#C9D1D9;">    fatal: </span><span style="color:#79C0FF;">1.0</span><span style="color:#C9D1D9;">,    </span><span style="color:#8B949E;">// 100% \u91C7\u6837\u81F4\u547D\u9519\u8BEF</span></span>
<span class="line"><span style="color:#C9D1D9;">    error: </span><span style="color:#79C0FF;">0.5</span><span style="color:#C9D1D9;">,    </span><span style="color:#8B949E;">// 50% \u91C7\u6837\u666E\u901A\u9519\u8BEF</span></span>
<span class="line"><span style="color:#C9D1D9;">    warning: </span><span style="color:#79C0FF;">0.1</span><span style="color:#C9D1D9;">,  </span><span style="color:#8B949E;">// 10% \u91C7\u6837\u8B66\u544A</span></span>
<span class="line"><span style="color:#C9D1D9;">    info: </span><span style="color:#79C0FF;">0.01</span><span style="color:#C9D1D9;">,    </span><span style="color:#8B949E;">// 1% \u91C7\u6837\u4FE1\u606F</span></span>
<span class="line"><span style="color:#C9D1D9;">    debug: </span><span style="color:#79C0FF;">0</span><span style="color:#C9D1D9;">       </span><span style="color:#8B949E;">// \u4E0D\u91C7\u6837\u8C03\u8BD5\u4FE1\u606F</span></span>
<span class="line"><span style="color:#C9D1D9;">  },</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// \u52A8\u6001\u91C7\u6837</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#D2A8FF;">shouldSample</span><span style="color:#C9D1D9;">: (</span><span style="color:#FFA657;">event</span><span style="color:#C9D1D9;">) </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#8B949E;">// \u603B\u662F\u91C7\u6837\u751F\u4EA7\u73AF\u5883\u7684\u9519\u8BEF</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (event.environment </span><span style="color:#FF7B72;">===</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;production&#39;</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">true</span><span style="color:#C9D1D9;">;</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#8B949E;">// \u57FA\u4E8E\u7528\u6237ID\u91C7\u6837</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (event.user </span><span style="color:#FF7B72;">&amp;&amp;</span><span style="color:#C9D1D9;"> event.user.id) {</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">hash</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">simpleHash</span><span style="color:#C9D1D9;">(event.user.id);</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> hash </span><span style="color:#FF7B72;">%</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">10</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">===</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">0</span><span style="color:#C9D1D9;">; </span><span style="color:#8B949E;">// 10% \u91C7\u6837</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> Math.</span><span style="color:#D2A8FF;">random</span><span style="color:#C9D1D9;">() </span><span style="color:#FF7B72;">&lt;</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">0.1</span><span style="color:#C9D1D9;">;</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"><span style="color:#C9D1D9;">});</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#CF222E;">const</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">errorHandler</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">new</span><span style="color:#24292F;"> </span><span style="color:#8250DF;">ZError</span><span style="color:#24292F;">({</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#6E7781;">// \u5168\u5C40\u91C7\u6837\u7387\uFF080-1\u4E4B\u95F4\uFF09</span></span>
<span class="line"><span style="color:#24292F;">  sampleRate: </span><span style="color:#0550AE;">0.1</span><span style="color:#24292F;">, </span><span style="color:#6E7781;">// \u53EA\u91C7\u683710%\u7684\u9519\u8BEF</span></span>
<span class="line"><span style="color:#24292F;">  </span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#6E7781;">// \u57FA\u4E8E\u9519\u8BEF\u7EA7\u522B\u7684\u91C7\u6837</span></span>
<span class="line"><span style="color:#24292F;">  sampleRates: {</span></span>
<span class="line"><span style="color:#24292F;">    fatal: </span><span style="color:#0550AE;">1.0</span><span style="color:#24292F;">,    </span><span style="color:#6E7781;">// 100% \u91C7\u6837\u81F4\u547D\u9519\u8BEF</span></span>
<span class="line"><span style="color:#24292F;">    error: </span><span style="color:#0550AE;">0.5</span><span style="color:#24292F;">,    </span><span style="color:#6E7781;">// 50% \u91C7\u6837\u666E\u901A\u9519\u8BEF</span></span>
<span class="line"><span style="color:#24292F;">    warning: </span><span style="color:#0550AE;">0.1</span><span style="color:#24292F;">,  </span><span style="color:#6E7781;">// 10% \u91C7\u6837\u8B66\u544A</span></span>
<span class="line"><span style="color:#24292F;">    info: </span><span style="color:#0550AE;">0.01</span><span style="color:#24292F;">,    </span><span style="color:#6E7781;">// 1% \u91C7\u6837\u4FE1\u606F</span></span>
<span class="line"><span style="color:#24292F;">    debug: </span><span style="color:#0550AE;">0</span><span style="color:#24292F;">       </span><span style="color:#6E7781;">// \u4E0D\u91C7\u6837\u8C03\u8BD5\u4FE1\u606F</span></span>
<span class="line"><span style="color:#24292F;">  },</span></span>
<span class="line"><span style="color:#24292F;">  </span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#6E7781;">// \u52A8\u6001\u91C7\u6837</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#8250DF;">shouldSample</span><span style="color:#24292F;">: (</span><span style="color:#953800;">event</span><span style="color:#24292F;">) </span><span style="color:#CF222E;">=&gt;</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#6E7781;">// \u603B\u662F\u91C7\u6837\u751F\u4EA7\u73AF\u5883\u7684\u9519\u8BEF</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#CF222E;">if</span><span style="color:#24292F;"> (event.environment </span><span style="color:#CF222E;">===</span><span style="color:#24292F;"> </span><span style="color:#0A3069;">&#39;production&#39;</span><span style="color:#24292F;">) {</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#CF222E;">return</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">true</span><span style="color:#24292F;">;</span></span>
<span class="line"><span style="color:#24292F;">    }</span></span>
<span class="line"><span style="color:#24292F;">    </span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#6E7781;">// \u57FA\u4E8E\u7528\u6237ID\u91C7\u6837</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#CF222E;">if</span><span style="color:#24292F;"> (event.user </span><span style="color:#CF222E;">&amp;&amp;</span><span style="color:#24292F;"> event.user.id) {</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#CF222E;">const</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">hash</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> </span><span style="color:#8250DF;">simpleHash</span><span style="color:#24292F;">(event.user.id);</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#CF222E;">return</span><span style="color:#24292F;"> hash </span><span style="color:#CF222E;">%</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">10</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">===</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">0</span><span style="color:#24292F;">; </span><span style="color:#6E7781;">// 10% \u91C7\u6837</span></span>
<span class="line"><span style="color:#24292F;">    }</span></span>
<span class="line"><span style="color:#24292F;">    </span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#CF222E;">return</span><span style="color:#24292F;"> Math.</span><span style="color:#8250DF;">random</span><span style="color:#24292F;">() </span><span style="color:#CF222E;">&lt;</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">0.1</span><span style="color:#24292F;">;</span></span>
<span class="line"><span style="color:#24292F;">  }</span></span>
<span class="line"><span style="color:#24292F;">});</span></span>
<span class="line"></span></code></pre></div><h2 id="\u6027\u80FD\u76D1\u63A7" tabindex="-1">\u6027\u80FD\u76D1\u63A7 <a class="header-anchor" href="#\u6027\u80FD\u76D1\u63A7" aria-hidden="true">#</a></h2><h3 id="\u6027\u80FD\u6307\u6807\u6536\u96C6" tabindex="-1">\u6027\u80FD\u6307\u6807\u6536\u96C6 <a class="header-anchor" href="#\u6027\u80FD\u6307\u6807\u6536\u96C6" aria-hidden="true">#</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#8B949E;">// \u542F\u7528\u6027\u80FD\u76D1\u63A7</span></span>
<span class="line"><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">errorHandler</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">new</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">ZError</span><span style="color:#C9D1D9;">({</span></span>
<span class="line"><span style="color:#C9D1D9;">  performance: {</span></span>
<span class="line"><span style="color:#C9D1D9;">    enabled: </span><span style="color:#79C0FF;">true</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#8B949E;">// \u76D1\u63A7\u7684\u6027\u80FD\u6307\u6807</span></span>
<span class="line"><span style="color:#C9D1D9;">    metrics: {</span></span>
<span class="line"><span style="color:#C9D1D9;">      navigation: </span><span style="color:#79C0FF;">true</span><span style="color:#C9D1D9;">,    </span><span style="color:#8B949E;">// \u9875\u9762\u5BFC\u822A\u6027\u80FD</span></span>
<span class="line"><span style="color:#C9D1D9;">      resources: </span><span style="color:#79C0FF;">true</span><span style="color:#C9D1D9;">,     </span><span style="color:#8B949E;">// \u8D44\u6E90\u52A0\u8F7D\u6027\u80FD</span></span>
<span class="line"><span style="color:#C9D1D9;">      paint: </span><span style="color:#79C0FF;">true</span><span style="color:#C9D1D9;">,         </span><span style="color:#8B949E;">// \u7ED8\u5236\u6027\u80FD</span></span>
<span class="line"><span style="color:#C9D1D9;">      layout: </span><span style="color:#79C0FF;">true</span><span style="color:#C9D1D9;">         </span><span style="color:#8B949E;">// \u5E03\u5C40\u6027\u80FD</span></span>
<span class="line"><span style="color:#C9D1D9;">    },</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#8B949E;">// \u6027\u80FD\u9608\u503C</span></span>
<span class="line"><span style="color:#C9D1D9;">    thresholds: {</span></span>
<span class="line"><span style="color:#C9D1D9;">      fcp: </span><span style="color:#79C0FF;">2000</span><span style="color:#C9D1D9;">,          </span><span style="color:#8B949E;">// First Contentful Paint</span></span>
<span class="line"><span style="color:#C9D1D9;">      lcp: </span><span style="color:#79C0FF;">4000</span><span style="color:#C9D1D9;">,          </span><span style="color:#8B949E;">// Largest Contentful Paint</span></span>
<span class="line"><span style="color:#C9D1D9;">      fid: </span><span style="color:#79C0FF;">100</span><span style="color:#C9D1D9;">,           </span><span style="color:#8B949E;">// First Input Delay</span></span>
<span class="line"><span style="color:#C9D1D9;">      cls: </span><span style="color:#79C0FF;">0.1</span><span style="color:#C9D1D9;">            </span><span style="color:#8B949E;">// Cumulative Layout Shift</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"><span style="color:#C9D1D9;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">// \u624B\u52A8\u8BB0\u5F55\u6027\u80FD\u6307\u6807</span></span>
<span class="line"><span style="color:#C9D1D9;">errorHandler.</span><span style="color:#D2A8FF;">addPerformanceEntry</span><span style="color:#C9D1D9;">({</span></span>
<span class="line"><span style="color:#C9D1D9;">  name: </span><span style="color:#A5D6FF;">&#39;api-call&#39;</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">  startTime: performance.</span><span style="color:#D2A8FF;">now</span><span style="color:#C9D1D9;">(),</span></span>
<span class="line"><span style="color:#C9D1D9;">  duration: </span><span style="color:#79C0FF;">150</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">  entryType: </span><span style="color:#A5D6FF;">&#39;measure&#39;</span></span>
<span class="line"><span style="color:#C9D1D9;">});</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#6E7781;">// \u542F\u7528\u6027\u80FD\u76D1\u63A7</span></span>
<span class="line"><span style="color:#CF222E;">const</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">errorHandler</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">new</span><span style="color:#24292F;"> </span><span style="color:#8250DF;">ZError</span><span style="color:#24292F;">({</span></span>
<span class="line"><span style="color:#24292F;">  performance: {</span></span>
<span class="line"><span style="color:#24292F;">    enabled: </span><span style="color:#0550AE;">true</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">    </span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#6E7781;">// \u76D1\u63A7\u7684\u6027\u80FD\u6307\u6807</span></span>
<span class="line"><span style="color:#24292F;">    metrics: {</span></span>
<span class="line"><span style="color:#24292F;">      navigation: </span><span style="color:#0550AE;">true</span><span style="color:#24292F;">,    </span><span style="color:#6E7781;">// \u9875\u9762\u5BFC\u822A\u6027\u80FD</span></span>
<span class="line"><span style="color:#24292F;">      resources: </span><span style="color:#0550AE;">true</span><span style="color:#24292F;">,     </span><span style="color:#6E7781;">// \u8D44\u6E90\u52A0\u8F7D\u6027\u80FD</span></span>
<span class="line"><span style="color:#24292F;">      paint: </span><span style="color:#0550AE;">true</span><span style="color:#24292F;">,         </span><span style="color:#6E7781;">// \u7ED8\u5236\u6027\u80FD</span></span>
<span class="line"><span style="color:#24292F;">      layout: </span><span style="color:#0550AE;">true</span><span style="color:#24292F;">         </span><span style="color:#6E7781;">// \u5E03\u5C40\u6027\u80FD</span></span>
<span class="line"><span style="color:#24292F;">    },</span></span>
<span class="line"><span style="color:#24292F;">    </span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#6E7781;">// \u6027\u80FD\u9608\u503C</span></span>
<span class="line"><span style="color:#24292F;">    thresholds: {</span></span>
<span class="line"><span style="color:#24292F;">      fcp: </span><span style="color:#0550AE;">2000</span><span style="color:#24292F;">,          </span><span style="color:#6E7781;">// First Contentful Paint</span></span>
<span class="line"><span style="color:#24292F;">      lcp: </span><span style="color:#0550AE;">4000</span><span style="color:#24292F;">,          </span><span style="color:#6E7781;">// Largest Contentful Paint</span></span>
<span class="line"><span style="color:#24292F;">      fid: </span><span style="color:#0550AE;">100</span><span style="color:#24292F;">,           </span><span style="color:#6E7781;">// First Input Delay</span></span>
<span class="line"><span style="color:#24292F;">      cls: </span><span style="color:#0550AE;">0.1</span><span style="color:#24292F;">            </span><span style="color:#6E7781;">// Cumulative Layout Shift</span></span>
<span class="line"><span style="color:#24292F;">    }</span></span>
<span class="line"><span style="color:#24292F;">  }</span></span>
<span class="line"><span style="color:#24292F;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6E7781;">// \u624B\u52A8\u8BB0\u5F55\u6027\u80FD\u6307\u6807</span></span>
<span class="line"><span style="color:#24292F;">errorHandler.</span><span style="color:#8250DF;">addPerformanceEntry</span><span style="color:#24292F;">({</span></span>
<span class="line"><span style="color:#24292F;">  name: </span><span style="color:#0A3069;">&#39;api-call&#39;</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">  startTime: performance.</span><span style="color:#8250DF;">now</span><span style="color:#24292F;">(),</span></span>
<span class="line"><span style="color:#24292F;">  duration: </span><span style="color:#0550AE;">150</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">  entryType: </span><span style="color:#0A3069;">&#39;measure&#39;</span></span>
<span class="line"><span style="color:#24292F;">});</span></span>
<span class="line"></span></code></pre></div><h3 id="\u81EA\u5B9A\u4E49\u6027\u80FD\u76D1\u63A7" tabindex="-1">\u81EA\u5B9A\u4E49\u6027\u80FD\u76D1\u63A7 <a class="header-anchor" href="#\u81EA\u5B9A\u4E49\u6027\u80FD\u76D1\u63A7" aria-hidden="true">#</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#8B949E;">// \u76D1\u63A7\u51FD\u6570\u6267\u884C\u65F6\u95F4</span></span>
<span class="line"><span style="color:#FF7B72;">function</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">measureFunction</span><span style="color:#C9D1D9;">(</span><span style="color:#FFA657;">fn</span><span style="color:#C9D1D9;">, </span><span style="color:#FFA657;">name</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">function</span><span style="color:#C9D1D9;">(</span><span style="color:#FF7B72;">...</span><span style="color:#FFA657;">args</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">start</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> performance.</span><span style="color:#D2A8FF;">now</span><span style="color:#C9D1D9;">();</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">result</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> fn.</span><span style="color:#D2A8FF;">apply</span><span style="color:#C9D1D9;">(</span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">, args);</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">duration</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> performance.</span><span style="color:#D2A8FF;">now</span><span style="color:#C9D1D9;">() </span><span style="color:#FF7B72;">-</span><span style="color:#C9D1D9;"> start;</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span></span>
<span class="line"><span style="color:#C9D1D9;">    errorHandler.</span><span style="color:#D2A8FF;">addBreadcrumb</span><span style="color:#C9D1D9;">({</span></span>
<span class="line"><span style="color:#C9D1D9;">      message: </span><span style="color:#A5D6FF;">\`\u51FD\u6570 \${</span><span style="color:#C9D1D9;">name</span><span style="color:#A5D6FF;">} \u6267\u884C\u5B8C\u6210\`</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">      category: </span><span style="color:#A5D6FF;">&#39;performance&#39;</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">      data: { duration, name }</span></span>
<span class="line"><span style="color:#C9D1D9;">    });</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (duration </span><span style="color:#FF7B72;">&gt;</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">1000</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">      errorHandler.</span><span style="color:#D2A8FF;">captureMessage</span><span style="color:#C9D1D9;">(</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#A5D6FF;">\`\u51FD\u6570 \${</span><span style="color:#C9D1D9;">name</span><span style="color:#A5D6FF;">} \u6267\u884C\u65F6\u95F4\u8FC7\u957F: \${</span><span style="color:#C9D1D9;">duration</span><span style="color:#A5D6FF;">}ms\`</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#A5D6FF;">&#39;warning&#39;</span></span>
<span class="line"><span style="color:#C9D1D9;">      );</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> result;</span></span>
<span class="line"><span style="color:#C9D1D9;">  };</span></span>
<span class="line"><span style="color:#C9D1D9;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">// \u4F7F\u7528\u793A\u4F8B</span></span>
<span class="line"><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">slowFunction</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">measureFunction</span><span style="color:#C9D1D9;">(</span><span style="color:#FF7B72;">function</span><span style="color:#C9D1D9;">() {</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// \u4E00\u4E9B\u53EF\u80FD\u5F88\u6162\u7684\u64CD\u4F5C</span></span>
<span class="line"><span style="color:#C9D1D9;">}, </span><span style="color:#A5D6FF;">&#39;slowFunction&#39;</span><span style="color:#C9D1D9;">);</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#6E7781;">// \u76D1\u63A7\u51FD\u6570\u6267\u884C\u65F6\u95F4</span></span>
<span class="line"><span style="color:#CF222E;">function</span><span style="color:#24292F;"> </span><span style="color:#8250DF;">measureFunction</span><span style="color:#24292F;">(</span><span style="color:#953800;">fn</span><span style="color:#24292F;">, </span><span style="color:#953800;">name</span><span style="color:#24292F;">) {</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#CF222E;">return</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">function</span><span style="color:#24292F;">(</span><span style="color:#CF222E;">...</span><span style="color:#953800;">args</span><span style="color:#24292F;">) {</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#CF222E;">const</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">start</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> performance.</span><span style="color:#8250DF;">now</span><span style="color:#24292F;">();</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#CF222E;">const</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">result</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> fn.</span><span style="color:#8250DF;">apply</span><span style="color:#24292F;">(</span><span style="color:#0550AE;">this</span><span style="color:#24292F;">, args);</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#CF222E;">const</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">duration</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> performance.</span><span style="color:#8250DF;">now</span><span style="color:#24292F;">() </span><span style="color:#CF222E;">-</span><span style="color:#24292F;"> start;</span></span>
<span class="line"><span style="color:#24292F;">    </span></span>
<span class="line"><span style="color:#24292F;">    errorHandler.</span><span style="color:#8250DF;">addBreadcrumb</span><span style="color:#24292F;">({</span></span>
<span class="line"><span style="color:#24292F;">      message: </span><span style="color:#0A3069;">\`\u51FD\u6570 \${</span><span style="color:#24292F;">name</span><span style="color:#0A3069;">} \u6267\u884C\u5B8C\u6210\`</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">      category: </span><span style="color:#0A3069;">&#39;performance&#39;</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">      data: { duration, name }</span></span>
<span class="line"><span style="color:#24292F;">    });</span></span>
<span class="line"><span style="color:#24292F;">    </span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#CF222E;">if</span><span style="color:#24292F;"> (duration </span><span style="color:#CF222E;">&gt;</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">1000</span><span style="color:#24292F;">) {</span></span>
<span class="line"><span style="color:#24292F;">      errorHandler.</span><span style="color:#8250DF;">captureMessage</span><span style="color:#24292F;">(</span></span>
<span class="line"><span style="color:#24292F;">        </span><span style="color:#0A3069;">\`\u51FD\u6570 \${</span><span style="color:#24292F;">name</span><span style="color:#0A3069;">} \u6267\u884C\u65F6\u95F4\u8FC7\u957F: \${</span><span style="color:#24292F;">duration</span><span style="color:#0A3069;">}ms\`</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">        </span><span style="color:#0A3069;">&#39;warning&#39;</span></span>
<span class="line"><span style="color:#24292F;">      );</span></span>
<span class="line"><span style="color:#24292F;">    }</span></span>
<span class="line"><span style="color:#24292F;">    </span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#CF222E;">return</span><span style="color:#24292F;"> result;</span></span>
<span class="line"><span style="color:#24292F;">  };</span></span>
<span class="line"><span style="color:#24292F;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6E7781;">// \u4F7F\u7528\u793A\u4F8B</span></span>
<span class="line"><span style="color:#CF222E;">const</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">slowFunction</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> </span><span style="color:#8250DF;">measureFunction</span><span style="color:#24292F;">(</span><span style="color:#CF222E;">function</span><span style="color:#24292F;">() {</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#6E7781;">// \u4E00\u4E9B\u53EF\u80FD\u5F88\u6162\u7684\u64CD\u4F5C</span></span>
<span class="line"><span style="color:#24292F;">}, </span><span style="color:#0A3069;">&#39;slowFunction&#39;</span><span style="color:#24292F;">);</span></span>
<span class="line"></span></code></pre></div><h2 id="\u96C6\u6210\u7B2C\u4E09\u65B9\u670D\u52A1" tabindex="-1">\u96C6\u6210\u7B2C\u4E09\u65B9\u670D\u52A1 <a class="header-anchor" href="#\u96C6\u6210\u7B2C\u4E09\u65B9\u670D\u52A1" aria-hidden="true">#</a></h2><h3 id="\u4E0E\u65E5\u5FD7\u670D\u52A1\u96C6\u6210" tabindex="-1">\u4E0E\u65E5\u5FD7\u670D\u52A1\u96C6\u6210 <a class="header-anchor" href="#\u4E0E\u65E5\u5FD7\u670D\u52A1\u96C6\u6210" aria-hidden="true">#</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">errorHandler</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">new</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">ZError</span><span style="color:#C9D1D9;">({</span></span>
<span class="line"><span style="color:#C9D1D9;">  integrations: [</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#8B949E;">// \u96C6\u6210\u5230 Sentry</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">new</span><span style="color:#C9D1D9;"> ZError.Integrations.</span><span style="color:#D2A8FF;">Sentry</span><span style="color:#C9D1D9;">({</span></span>
<span class="line"><span style="color:#C9D1D9;">      dsn: </span><span style="color:#A5D6FF;">&#39;your-sentry-dsn&#39;</span></span>
<span class="line"><span style="color:#C9D1D9;">    }),</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#8B949E;">// \u96C6\u6210\u5230 LogRocket</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">new</span><span style="color:#C9D1D9;"> ZError.Integrations.</span><span style="color:#D2A8FF;">LogRocket</span><span style="color:#C9D1D9;">({</span></span>
<span class="line"><span style="color:#C9D1D9;">      appID: </span><span style="color:#A5D6FF;">&#39;your-logrocket-app-id&#39;</span></span>
<span class="line"><span style="color:#C9D1D9;">    }),</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#8B949E;">// \u81EA\u5B9A\u4E49\u96C6\u6210</span></span>
<span class="line"><span style="color:#C9D1D9;">    {</span></span>
<span class="line"><span style="color:#C9D1D9;">      name: </span><span style="color:#A5D6FF;">&#39;CustomLogger&#39;</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#D2A8FF;">setupOnce</span><span style="color:#C9D1D9;">: () </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">        errorHandler.</span><span style="color:#D2A8FF;">addEventProcessor</span><span style="color:#C9D1D9;">((</span><span style="color:#FFA657;">event</span><span style="color:#C9D1D9;">) </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">          </span><span style="color:#8B949E;">// \u53D1\u9001\u5230\u81EA\u5B9A\u4E49\u65E5\u5FD7\u670D\u52A1</span></span>
<span class="line"><span style="color:#C9D1D9;">          </span><span style="color:#D2A8FF;">fetch</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&#39;/api/logs&#39;</span><span style="color:#C9D1D9;">, {</span></span>
<span class="line"><span style="color:#C9D1D9;">            method: </span><span style="color:#A5D6FF;">&#39;POST&#39;</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">            body: </span><span style="color:#79C0FF;">JSON</span><span style="color:#C9D1D9;">.</span><span style="color:#D2A8FF;">stringify</span><span style="color:#C9D1D9;">(event)</span></span>
<span class="line"><span style="color:#C9D1D9;">          });</span></span>
<span class="line"><span style="color:#C9D1D9;">          </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> event;</span></span>
<span class="line"><span style="color:#C9D1D9;">        });</span></span>
<span class="line"><span style="color:#C9D1D9;">      }</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#C9D1D9;">  ]</span></span>
<span class="line"><span style="color:#C9D1D9;">});</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#CF222E;">const</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">errorHandler</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">new</span><span style="color:#24292F;"> </span><span style="color:#8250DF;">ZError</span><span style="color:#24292F;">({</span></span>
<span class="line"><span style="color:#24292F;">  integrations: [</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#6E7781;">// \u96C6\u6210\u5230 Sentry</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#CF222E;">new</span><span style="color:#24292F;"> ZError.Integrations.</span><span style="color:#8250DF;">Sentry</span><span style="color:#24292F;">({</span></span>
<span class="line"><span style="color:#24292F;">      dsn: </span><span style="color:#0A3069;">&#39;your-sentry-dsn&#39;</span></span>
<span class="line"><span style="color:#24292F;">    }),</span></span>
<span class="line"><span style="color:#24292F;">    </span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#6E7781;">// \u96C6\u6210\u5230 LogRocket</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#CF222E;">new</span><span style="color:#24292F;"> ZError.Integrations.</span><span style="color:#8250DF;">LogRocket</span><span style="color:#24292F;">({</span></span>
<span class="line"><span style="color:#24292F;">      appID: </span><span style="color:#0A3069;">&#39;your-logrocket-app-id&#39;</span></span>
<span class="line"><span style="color:#24292F;">    }),</span></span>
<span class="line"><span style="color:#24292F;">    </span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#6E7781;">// \u81EA\u5B9A\u4E49\u96C6\u6210</span></span>
<span class="line"><span style="color:#24292F;">    {</span></span>
<span class="line"><span style="color:#24292F;">      name: </span><span style="color:#0A3069;">&#39;CustomLogger&#39;</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#8250DF;">setupOnce</span><span style="color:#24292F;">: () </span><span style="color:#CF222E;">=&gt;</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">        errorHandler.</span><span style="color:#8250DF;">addEventProcessor</span><span style="color:#24292F;">((</span><span style="color:#953800;">event</span><span style="color:#24292F;">) </span><span style="color:#CF222E;">=&gt;</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">          </span><span style="color:#6E7781;">// \u53D1\u9001\u5230\u81EA\u5B9A\u4E49\u65E5\u5FD7\u670D\u52A1</span></span>
<span class="line"><span style="color:#24292F;">          </span><span style="color:#8250DF;">fetch</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">&#39;/api/logs&#39;</span><span style="color:#24292F;">, {</span></span>
<span class="line"><span style="color:#24292F;">            method: </span><span style="color:#0A3069;">&#39;POST&#39;</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">            body: </span><span style="color:#0550AE;">JSON</span><span style="color:#24292F;">.</span><span style="color:#8250DF;">stringify</span><span style="color:#24292F;">(event)</span></span>
<span class="line"><span style="color:#24292F;">          });</span></span>
<span class="line"><span style="color:#24292F;">          </span><span style="color:#CF222E;">return</span><span style="color:#24292F;"> event;</span></span>
<span class="line"><span style="color:#24292F;">        });</span></span>
<span class="line"><span style="color:#24292F;">      }</span></span>
<span class="line"><span style="color:#24292F;">    }</span></span>
<span class="line"><span style="color:#24292F;">  ]</span></span>
<span class="line"><span style="color:#24292F;">});</span></span>
<span class="line"></span></code></pre></div><h2 id="\u8C03\u8BD5\u548C\u6D4B\u8BD5" tabindex="-1">\u8C03\u8BD5\u548C\u6D4B\u8BD5 <a class="header-anchor" href="#\u8C03\u8BD5\u548C\u6D4B\u8BD5" aria-hidden="true">#</a></h2><h3 id="\u8C03\u8BD5\u6A21\u5F0F" tabindex="-1">\u8C03\u8BD5\u6A21\u5F0F <a class="header-anchor" href="#\u8C03\u8BD5\u6A21\u5F0F" aria-hidden="true">#</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">errorHandler</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">new</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">ZError</span><span style="color:#C9D1D9;">({</span></span>
<span class="line"><span style="color:#C9D1D9;">  debug: </span><span style="color:#79C0FF;">true</span><span style="color:#C9D1D9;">,  </span><span style="color:#8B949E;">// \u542F\u7528\u8C03\u8BD5\u6A21\u5F0F</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// \u81EA\u5B9A\u4E49\u8C03\u8BD5\u8F93\u51FA</span></span>
<span class="line"><span style="color:#C9D1D9;">  debugLogger: {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#D2A8FF;">log</span><span style="color:#C9D1D9;">: (</span><span style="color:#FFA657;">message</span><span style="color:#C9D1D9;">, </span><span style="color:#FFA657;">data</span><span style="color:#C9D1D9;">) </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">      console.</span><span style="color:#D2A8FF;">log</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">\`[ZError] \${</span><span style="color:#C9D1D9;">message</span><span style="color:#A5D6FF;">}\`</span><span style="color:#C9D1D9;">, data);</span></span>
<span class="line"><span style="color:#C9D1D9;">    },</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#D2A8FF;">warn</span><span style="color:#C9D1D9;">: (</span><span style="color:#FFA657;">message</span><span style="color:#C9D1D9;">, </span><span style="color:#FFA657;">data</span><span style="color:#C9D1D9;">) </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">      console.</span><span style="color:#D2A8FF;">warn</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">\`[ZError] \${</span><span style="color:#C9D1D9;">message</span><span style="color:#A5D6FF;">}\`</span><span style="color:#C9D1D9;">, data);</span></span>
<span class="line"><span style="color:#C9D1D9;">    },</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#D2A8FF;">error</span><span style="color:#C9D1D9;">: (</span><span style="color:#FFA657;">message</span><span style="color:#C9D1D9;">, </span><span style="color:#FFA657;">data</span><span style="color:#C9D1D9;">) </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">      console.</span><span style="color:#D2A8FF;">error</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">\`[ZError] \${</span><span style="color:#C9D1D9;">message</span><span style="color:#A5D6FF;">}\`</span><span style="color:#C9D1D9;">, data);</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"><span style="color:#C9D1D9;">});</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#CF222E;">const</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">errorHandler</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">new</span><span style="color:#24292F;"> </span><span style="color:#8250DF;">ZError</span><span style="color:#24292F;">({</span></span>
<span class="line"><span style="color:#24292F;">  debug: </span><span style="color:#0550AE;">true</span><span style="color:#24292F;">,  </span><span style="color:#6E7781;">// \u542F\u7528\u8C03\u8BD5\u6A21\u5F0F</span></span>
<span class="line"><span style="color:#24292F;">  </span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#6E7781;">// \u81EA\u5B9A\u4E49\u8C03\u8BD5\u8F93\u51FA</span></span>
<span class="line"><span style="color:#24292F;">  debugLogger: {</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#8250DF;">log</span><span style="color:#24292F;">: (</span><span style="color:#953800;">message</span><span style="color:#24292F;">, </span><span style="color:#953800;">data</span><span style="color:#24292F;">) </span><span style="color:#CF222E;">=&gt;</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">      console.</span><span style="color:#8250DF;">log</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">\`[ZError] \${</span><span style="color:#24292F;">message</span><span style="color:#0A3069;">}\`</span><span style="color:#24292F;">, data);</span></span>
<span class="line"><span style="color:#24292F;">    },</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#8250DF;">warn</span><span style="color:#24292F;">: (</span><span style="color:#953800;">message</span><span style="color:#24292F;">, </span><span style="color:#953800;">data</span><span style="color:#24292F;">) </span><span style="color:#CF222E;">=&gt;</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">      console.</span><span style="color:#8250DF;">warn</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">\`[ZError] \${</span><span style="color:#24292F;">message</span><span style="color:#0A3069;">}\`</span><span style="color:#24292F;">, data);</span></span>
<span class="line"><span style="color:#24292F;">    },</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#8250DF;">error</span><span style="color:#24292F;">: (</span><span style="color:#953800;">message</span><span style="color:#24292F;">, </span><span style="color:#953800;">data</span><span style="color:#24292F;">) </span><span style="color:#CF222E;">=&gt;</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">      console.</span><span style="color:#8250DF;">error</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">\`[ZError] \${</span><span style="color:#24292F;">message</span><span style="color:#0A3069;">}\`</span><span style="color:#24292F;">, data);</span></span>
<span class="line"><span style="color:#24292F;">    }</span></span>
<span class="line"><span style="color:#24292F;">  }</span></span>
<span class="line"><span style="color:#24292F;">});</span></span>
<span class="line"></span></code></pre></div><h3 id="\u6D4B\u8BD5\u9519\u8BEF\u5904\u7406" tabindex="-1">\u6D4B\u8BD5\u9519\u8BEF\u5904\u7406 <a class="header-anchor" href="#\u6D4B\u8BD5\u9519\u8BEF\u5904\u7406" aria-hidden="true">#</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#8B949E;">// \u6D4B\u8BD5\u4E0D\u540C\u7C7B\u578B\u7684\u9519\u8BEF</span></span>
<span class="line"><span style="color:#FF7B72;">function</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">testErrorHandling</span><span style="color:#C9D1D9;">() {</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// \u6D4B\u8BD5\u540C\u6B65\u9519\u8BEF</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">try</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">throw</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">new</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">Error</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&#39;\u6D4B\u8BD5\u540C\u6B65\u9519\u8BEF&#39;</span><span style="color:#C9D1D9;">);</span></span>
<span class="line"><span style="color:#C9D1D9;">  } </span><span style="color:#FF7B72;">catch</span><span style="color:#C9D1D9;"> (e) {</span></span>
<span class="line"><span style="color:#C9D1D9;">    errorHandler.</span><span style="color:#D2A8FF;">captureError</span><span style="color:#C9D1D9;">(e);</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// \u6D4B\u8BD5\u5F02\u6B65\u9519\u8BEF</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#D2A8FF;">setTimeout</span><span style="color:#C9D1D9;">(() </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">throw</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">new</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">Error</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&#39;\u6D4B\u8BD5\u5F02\u6B65\u9519\u8BEF&#39;</span><span style="color:#C9D1D9;">);</span></span>
<span class="line"><span style="color:#C9D1D9;">  }, </span><span style="color:#79C0FF;">100</span><span style="color:#C9D1D9;">);</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// \u6D4B\u8BD5 Promise \u9519\u8BEF</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#79C0FF;">Promise</span><span style="color:#C9D1D9;">.</span><span style="color:#D2A8FF;">reject</span><span style="color:#C9D1D9;">(</span><span style="color:#FF7B72;">new</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">Error</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&#39;\u6D4B\u8BD5 Promise \u9519\u8BEF&#39;</span><span style="color:#C9D1D9;">));</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// \u6D4B\u8BD5\u7F51\u7EDC\u9519\u8BEF</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#D2A8FF;">fetch</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&#39;/nonexistent-endpoint&#39;</span><span style="color:#C9D1D9;">)</span></span>
<span class="line"><span style="color:#C9D1D9;">    .</span><span style="color:#D2A8FF;">catch</span><span style="color:#C9D1D9;">(</span><span style="color:#FFA657;">error</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">      errorHandler.</span><span style="color:#D2A8FF;">captureError</span><span style="color:#C9D1D9;">(error);</span></span>
<span class="line"><span style="color:#C9D1D9;">    });</span></span>
<span class="line"><span style="color:#C9D1D9;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">// \u5728\u5F00\u53D1\u73AF\u5883\u4E2D\u8FD0\u884C\u6D4B\u8BD5</span></span>
<span class="line"><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (p<wbr>rocess.env.</span><span style="color:#79C0FF;">NODE_ENV</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">===</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;development&#39;</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">  window.testZError </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> testErrorHandling;</span></span>
<span class="line"><span style="color:#C9D1D9;">}</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#6E7781;">// \u6D4B\u8BD5\u4E0D\u540C\u7C7B\u578B\u7684\u9519\u8BEF</span></span>
<span class="line"><span style="color:#CF222E;">function</span><span style="color:#24292F;"> </span><span style="color:#8250DF;">testErrorHandling</span><span style="color:#24292F;">() {</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#6E7781;">// \u6D4B\u8BD5\u540C\u6B65\u9519\u8BEF</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#CF222E;">try</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#CF222E;">throw</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">new</span><span style="color:#24292F;"> </span><span style="color:#8250DF;">Error</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">&#39;\u6D4B\u8BD5\u540C\u6B65\u9519\u8BEF&#39;</span><span style="color:#24292F;">);</span></span>
<span class="line"><span style="color:#24292F;">  } </span><span style="color:#CF222E;">catch</span><span style="color:#24292F;"> (e) {</span></span>
<span class="line"><span style="color:#24292F;">    errorHandler.</span><span style="color:#8250DF;">captureError</span><span style="color:#24292F;">(e);</span></span>
<span class="line"><span style="color:#24292F;">  }</span></span>
<span class="line"><span style="color:#24292F;">  </span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#6E7781;">// \u6D4B\u8BD5\u5F02\u6B65\u9519\u8BEF</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#8250DF;">setTimeout</span><span style="color:#24292F;">(() </span><span style="color:#CF222E;">=&gt;</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#CF222E;">throw</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">new</span><span style="color:#24292F;"> </span><span style="color:#8250DF;">Error</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">&#39;\u6D4B\u8BD5\u5F02\u6B65\u9519\u8BEF&#39;</span><span style="color:#24292F;">);</span></span>
<span class="line"><span style="color:#24292F;">  }, </span><span style="color:#0550AE;">100</span><span style="color:#24292F;">);</span></span>
<span class="line"><span style="color:#24292F;">  </span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#6E7781;">// \u6D4B\u8BD5 Promise \u9519\u8BEF</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#0550AE;">Promise</span><span style="color:#24292F;">.</span><span style="color:#8250DF;">reject</span><span style="color:#24292F;">(</span><span style="color:#CF222E;">new</span><span style="color:#24292F;"> </span><span style="color:#8250DF;">Error</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">&#39;\u6D4B\u8BD5 Promise \u9519\u8BEF&#39;</span><span style="color:#24292F;">));</span></span>
<span class="line"><span style="color:#24292F;">  </span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#6E7781;">// \u6D4B\u8BD5\u7F51\u7EDC\u9519\u8BEF</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#8250DF;">fetch</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">&#39;/nonexistent-endpoint&#39;</span><span style="color:#24292F;">)</span></span>
<span class="line"><span style="color:#24292F;">    .</span><span style="color:#8250DF;">catch</span><span style="color:#24292F;">(</span><span style="color:#953800;">error</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=&gt;</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">      errorHandler.</span><span style="color:#8250DF;">captureError</span><span style="color:#24292F;">(error);</span></span>
<span class="line"><span style="color:#24292F;">    });</span></span>
<span class="line"><span style="color:#24292F;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6E7781;">// \u5728\u5F00\u53D1\u73AF\u5883\u4E2D\u8FD0\u884C\u6D4B\u8BD5</span></span>
<span class="line"><span style="color:#CF222E;">if</span><span style="color:#24292F;"> (p<wbr>rocess.env.</span><span style="color:#0550AE;">NODE_ENV</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">===</span><span style="color:#24292F;"> </span><span style="color:#0A3069;">&#39;development&#39;</span><span style="color:#24292F;">) {</span></span>
<span class="line"><span style="color:#24292F;">  window.testZError </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> testErrorHandling;</span></span>
<span class="line"><span style="color:#24292F;">}</span></span>
<span class="line"></span></code></pre></div><h2 id="\u6700\u4F73\u5B9E\u8DF5" tabindex="-1">\u6700\u4F73\u5B9E\u8DF5 <a class="header-anchor" href="#\u6700\u4F73\u5B9E\u8DF5" aria-hidden="true">#</a></h2><h3 id="_1-\u5408\u7406\u8BBE\u7F6E\u9519\u8BEF\u7EA7\u522B" tabindex="-1">1. \u5408\u7406\u8BBE\u7F6E\u9519\u8BEF\u7EA7\u522B <a class="header-anchor" href="#_1-\u5408\u7406\u8BBE\u7F6E\u9519\u8BEF\u7EA7\u522B" aria-hidden="true">#</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#8B949E;">// \u274C \u9519\u8BEF\u7684\u505A\u6CD5</span></span>
<span class="line"><span style="color:#C9D1D9;">errorHandler.</span><span style="color:#D2A8FF;">captureMessage</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&#39;\u7528\u6237\u70B9\u51FB\u6309\u94AE&#39;</span><span style="color:#C9D1D9;">, </span><span style="color:#A5D6FF;">&#39;error&#39;</span><span style="color:#C9D1D9;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">// \u2705 \u6B63\u786E\u7684\u505A\u6CD5</span></span>
<span class="line"><span style="color:#C9D1D9;">errorHandler.</span><span style="color:#D2A8FF;">captureMessage</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&#39;\u7528\u6237\u70B9\u51FB\u6309\u94AE&#39;</span><span style="color:#C9D1D9;">, </span><span style="color:#A5D6FF;">&#39;info&#39;</span><span style="color:#C9D1D9;">);</span></span>
<span class="line"><span style="color:#C9D1D9;">errorHandler.</span><span style="color:#D2A8FF;">captureMessage</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&#39;\u652F\u4ED8\u5904\u7406\u5931\u8D25&#39;</span><span style="color:#C9D1D9;">, </span><span style="color:#A5D6FF;">&#39;error&#39;</span><span style="color:#C9D1D9;">);</span></span>
<span class="line"><span style="color:#C9D1D9;">errorHandler.</span><span style="color:#D2A8FF;">captureMessage</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&#39;\u5E94\u7528\u5D29\u6E83&#39;</span><span style="color:#C9D1D9;">, </span><span style="color:#A5D6FF;">&#39;fatal&#39;</span><span style="color:#C9D1D9;">);</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#6E7781;">// \u274C \u9519\u8BEF\u7684\u505A\u6CD5</span></span>
<span class="line"><span style="color:#24292F;">errorHandler.</span><span style="color:#8250DF;">captureMessage</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">&#39;\u7528\u6237\u70B9\u51FB\u6309\u94AE&#39;</span><span style="color:#24292F;">, </span><span style="color:#0A3069;">&#39;error&#39;</span><span style="color:#24292F;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6E7781;">// \u2705 \u6B63\u786E\u7684\u505A\u6CD5</span></span>
<span class="line"><span style="color:#24292F;">errorHandler.</span><span style="color:#8250DF;">captureMessage</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">&#39;\u7528\u6237\u70B9\u51FB\u6309\u94AE&#39;</span><span style="color:#24292F;">, </span><span style="color:#0A3069;">&#39;info&#39;</span><span style="color:#24292F;">);</span></span>
<span class="line"><span style="color:#24292F;">errorHandler.</span><span style="color:#8250DF;">captureMessage</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">&#39;\u652F\u4ED8\u5904\u7406\u5931\u8D25&#39;</span><span style="color:#24292F;">, </span><span style="color:#0A3069;">&#39;error&#39;</span><span style="color:#24292F;">);</span></span>
<span class="line"><span style="color:#24292F;">errorHandler.</span><span style="color:#8250DF;">captureMessage</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">&#39;\u5E94\u7528\u5D29\u6E83&#39;</span><span style="color:#24292F;">, </span><span style="color:#0A3069;">&#39;fatal&#39;</span><span style="color:#24292F;">);</span></span>
<span class="line"></span></code></pre></div><h3 id="_2-\u63D0\u4F9B\u6709\u7528\u7684\u4E0A\u4E0B\u6587" tabindex="-1">2. \u63D0\u4F9B\u6709\u7528\u7684\u4E0A\u4E0B\u6587 <a class="header-anchor" href="#_2-\u63D0\u4F9B\u6709\u7528\u7684\u4E0A\u4E0B\u6587" aria-hidden="true">#</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#8B949E;">// \u274C \u7F3A\u5C11\u4E0A\u4E0B\u6587</span></span>
<span class="line"><span style="color:#C9D1D9;">errorHandler.</span><span style="color:#D2A8FF;">captureError</span><span style="color:#C9D1D9;">(error);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">// \u2705 \u63D0\u4F9B\u4E30\u5BCC\u7684\u4E0A\u4E0B\u6587</span></span>
<span class="line"><span style="color:#C9D1D9;">errorHandler.</span><span style="color:#D2A8FF;">captureError</span><span style="color:#C9D1D9;">(error, {</span></span>
<span class="line"><span style="color:#C9D1D9;">  tags: {</span></span>
<span class="line"><span style="color:#C9D1D9;">    component: </span><span style="color:#A5D6FF;">&#39;checkout&#39;</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">    step: </span><span style="color:#A5D6FF;">&#39;payment&#39;</span></span>
<span class="line"><span style="color:#C9D1D9;">  },</span></span>
<span class="line"><span style="color:#C9D1D9;">  extra: {</span></span>
<span class="line"><span style="color:#C9D1D9;">    userId: user.id,</span></span>
<span class="line"><span style="color:#C9D1D9;">    orderId: order.id,</span></span>
<span class="line"><span style="color:#C9D1D9;">    paymentMethod: </span><span style="color:#A5D6FF;">&#39;credit_card&#39;</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">    amount: order.total</span></span>
<span class="line"><span style="color:#C9D1D9;">  },</span></span>
<span class="line"><span style="color:#C9D1D9;">  user: {</span></span>
<span class="line"><span style="color:#C9D1D9;">    id: user.id,</span></span>
<span class="line"><span style="color:#C9D1D9;">    email: user.email</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"><span style="color:#C9D1D9;">});</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#6E7781;">// \u274C \u7F3A\u5C11\u4E0A\u4E0B\u6587</span></span>
<span class="line"><span style="color:#24292F;">errorHandler.</span><span style="color:#8250DF;">captureError</span><span style="color:#24292F;">(error);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6E7781;">// \u2705 \u63D0\u4F9B\u4E30\u5BCC\u7684\u4E0A\u4E0B\u6587</span></span>
<span class="line"><span style="color:#24292F;">errorHandler.</span><span style="color:#8250DF;">captureError</span><span style="color:#24292F;">(error, {</span></span>
<span class="line"><span style="color:#24292F;">  tags: {</span></span>
<span class="line"><span style="color:#24292F;">    component: </span><span style="color:#0A3069;">&#39;checkout&#39;</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">    step: </span><span style="color:#0A3069;">&#39;payment&#39;</span></span>
<span class="line"><span style="color:#24292F;">  },</span></span>
<span class="line"><span style="color:#24292F;">  extra: {</span></span>
<span class="line"><span style="color:#24292F;">    userId: user.id,</span></span>
<span class="line"><span style="color:#24292F;">    orderId: order.id,</span></span>
<span class="line"><span style="color:#24292F;">    paymentMethod: </span><span style="color:#0A3069;">&#39;credit_card&#39;</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">    amount: order.total</span></span>
<span class="line"><span style="color:#24292F;">  },</span></span>
<span class="line"><span style="color:#24292F;">  user: {</span></span>
<span class="line"><span style="color:#24292F;">    id: user.id,</span></span>
<span class="line"><span style="color:#24292F;">    email: user.email</span></span>
<span class="line"><span style="color:#24292F;">  }</span></span>
<span class="line"><span style="color:#24292F;">});</span></span>
<span class="line"></span></code></pre></div><h3 id="_3-\u907F\u514D\u654F\u611F\u4FE1\u606F\u6CC4\u9732" tabindex="-1">3. \u907F\u514D\u654F\u611F\u4FE1\u606F\u6CC4\u9732 <a class="header-anchor" href="#_3-\u907F\u514D\u654F\u611F\u4FE1\u606F\u6CC4\u9732" aria-hidden="true">#</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">errorHandler</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">new</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">ZError</span><span style="color:#C9D1D9;">({</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#D2A8FF;">beforeSend</span><span style="color:#C9D1D9;">: (</span><span style="color:#FFA657;">event</span><span style="color:#C9D1D9;">) </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#8B949E;">// \u79FB\u9664\u654F\u611F\u4FE1\u606F</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (event.extra) {</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">delete</span><span style="color:#C9D1D9;"> event.extra.password;</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">delete</span><span style="color:#C9D1D9;"> event.extra.creditCard;</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">delete</span><span style="color:#C9D1D9;"> event.extra.ssn;</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#8B949E;">// \u8131\u654F\u5904\u7406</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (event.user </span><span style="color:#FF7B72;">&amp;&amp;</span><span style="color:#C9D1D9;"> event.user.email) {</span></span>
<span class="line"><span style="color:#C9D1D9;">      event.user.email </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> event.user.email.</span><span style="color:#D2A8FF;">replace</span><span style="color:#C9D1D9;">(</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#A5D6FF;">/(</span><span style="color:#79C0FF;">.</span><span style="color:#FF7B72;">{2}</span><span style="color:#A5D6FF;">)</span><span style="color:#79C0FF;">.</span><span style="color:#FF7B72;">*</span><span style="color:#A5D6FF;">(@</span><span style="color:#79C0FF;">.</span><span style="color:#FF7B72;">*</span><span style="color:#A5D6FF;">)/</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#A5D6FF;">&#39;$1***$2&#39;</span></span>
<span class="line"><span style="color:#C9D1D9;">      );</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> event;</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"><span style="color:#C9D1D9;">});</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#CF222E;">const</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">errorHandler</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">new</span><span style="color:#24292F;"> </span><span style="color:#8250DF;">ZError</span><span style="color:#24292F;">({</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#8250DF;">beforeSend</span><span style="color:#24292F;">: (</span><span style="color:#953800;">event</span><span style="color:#24292F;">) </span><span style="color:#CF222E;">=&gt;</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#6E7781;">// \u79FB\u9664\u654F\u611F\u4FE1\u606F</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#CF222E;">if</span><span style="color:#24292F;"> (event.extra) {</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#CF222E;">delete</span><span style="color:#24292F;"> event.extra.password;</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#CF222E;">delete</span><span style="color:#24292F;"> event.extra.creditCard;</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#CF222E;">delete</span><span style="color:#24292F;"> event.extra.ssn;</span></span>
<span class="line"><span style="color:#24292F;">    }</span></span>
<span class="line"><span style="color:#24292F;">    </span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#6E7781;">// \u8131\u654F\u5904\u7406</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#CF222E;">if</span><span style="color:#24292F;"> (event.user </span><span style="color:#CF222E;">&amp;&amp;</span><span style="color:#24292F;"> event.user.email) {</span></span>
<span class="line"><span style="color:#24292F;">      event.user.email </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> event.user.email.</span><span style="color:#8250DF;">replace</span><span style="color:#24292F;">(</span></span>
<span class="line"><span style="color:#24292F;">        </span><span style="color:#0A3069;">/(</span><span style="color:#0550AE;">.</span><span style="color:#CF222E;">{2}</span><span style="color:#0A3069;">)</span><span style="color:#0550AE;">.</span><span style="color:#CF222E;">*</span><span style="color:#0A3069;">(@</span><span style="color:#0550AE;">.</span><span style="color:#CF222E;">*</span><span style="color:#0A3069;">)/</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">        </span><span style="color:#0A3069;">&#39;$1***$2&#39;</span></span>
<span class="line"><span style="color:#24292F;">      );</span></span>
<span class="line"><span style="color:#24292F;">    }</span></span>
<span class="line"><span style="color:#24292F;">    </span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#CF222E;">return</span><span style="color:#24292F;"> event;</span></span>
<span class="line"><span style="color:#24292F;">  }</span></span>
<span class="line"><span style="color:#24292F;">});</span></span>
<span class="line"></span></code></pre></div><h3 id="_4-\u5408\u7406\u4F7F\u7528\u91C7\u6837" tabindex="-1">4. \u5408\u7406\u4F7F\u7528\u91C7\u6837 <a class="header-anchor" href="#_4-\u5408\u7406\u4F7F\u7528\u91C7\u6837" aria-hidden="true">#</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#8B949E;">// \u6839\u636E\u73AF\u5883\u548C\u7528\u6237\u7C7B\u578B\u8BBE\u7F6E\u4E0D\u540C\u7684\u91C7\u6837\u7387</span></span>
<span class="line"><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">getSampleRate</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> () </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (p<wbr>rocess.env.</span><span style="color:#79C0FF;">NODE_ENV</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">===</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;development&#39;</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">1.0</span><span style="color:#C9D1D9;">; </span><span style="color:#8B949E;">// \u5F00\u53D1\u73AF\u5883100%\u91C7\u6837</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (user.isPremium) {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">0.5</span><span style="color:#C9D1D9;">; </span><span style="color:#8B949E;">// \u4ED8\u8D39\u7528\u623750%\u91C7\u6837</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">0.1</span><span style="color:#C9D1D9;">; </span><span style="color:#8B949E;">// \u666E\u901A\u7528\u623710%\u91C7\u6837</span></span>
<span class="line"><span style="color:#C9D1D9;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">errorHandler</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">new</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">ZError</span><span style="color:#C9D1D9;">({</span></span>
<span class="line"><span style="color:#C9D1D9;">  sampleRate: </span><span style="color:#D2A8FF;">getSampleRate</span><span style="color:#C9D1D9;">()</span></span>
<span class="line"><span style="color:#C9D1D9;">});</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#6E7781;">// \u6839\u636E\u73AF\u5883\u548C\u7528\u6237\u7C7B\u578B\u8BBE\u7F6E\u4E0D\u540C\u7684\u91C7\u6837\u7387</span></span>
<span class="line"><span style="color:#CF222E;">const</span><span style="color:#24292F;"> </span><span style="color:#8250DF;">getSampleRate</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> () </span><span style="color:#CF222E;">=&gt;</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#CF222E;">if</span><span style="color:#24292F;"> (p<wbr>rocess.env.</span><span style="color:#0550AE;">NODE_ENV</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">===</span><span style="color:#24292F;"> </span><span style="color:#0A3069;">&#39;development&#39;</span><span style="color:#24292F;">) {</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#CF222E;">return</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">1.0</span><span style="color:#24292F;">; </span><span style="color:#6E7781;">// \u5F00\u53D1\u73AF\u5883100%\u91C7\u6837</span></span>
<span class="line"><span style="color:#24292F;">  }</span></span>
<span class="line"><span style="color:#24292F;">  </span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#CF222E;">if</span><span style="color:#24292F;"> (user.isPremium) {</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#CF222E;">return</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">0.5</span><span style="color:#24292F;">; </span><span style="color:#6E7781;">// \u4ED8\u8D39\u7528\u623750%\u91C7\u6837</span></span>
<span class="line"><span style="color:#24292F;">  }</span></span>
<span class="line"><span style="color:#24292F;">  </span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#CF222E;">return</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">0.1</span><span style="color:#24292F;">; </span><span style="color:#6E7781;">// \u666E\u901A\u7528\u623710%\u91C7\u6837</span></span>
<span class="line"><span style="color:#24292F;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CF222E;">const</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">errorHandler</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">new</span><span style="color:#24292F;"> </span><span style="color:#8250DF;">ZError</span><span style="color:#24292F;">({</span></span>
<span class="line"><span style="color:#24292F;">  sampleRate: </span><span style="color:#8250DF;">getSampleRate</span><span style="color:#24292F;">()</span></span>
<span class="line"><span style="color:#24292F;">});</span></span>
<span class="line"></span></code></pre></div><p>\u901A\u8FC7\u9075\u5FAA\u8FD9\u4E9B\u6307\u5357\u548C\u6700\u4F73\u5B9E\u8DF5\uFF0C\u60A8\u53EF\u4EE5\u5145\u5206\u5229\u7528ZError\u7684\u5F3A\u5927\u529F\u80FD\uFF0C\u6784\u5EFA\u66F4\u52A0\u7A33\u5B9A\u548C\u53EF\u9760\u7684\u5E94\u7528\u7A0B\u5E8F\u3002</p>`,46),e=[o];function c(r,t,y,F,D,i){return n(),a("div",null,e)}const E=s(p,[["render",c]]);export{d as __pageData,E as default};
